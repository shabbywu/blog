import{_ as d,a as t}from"./å®¹å™¨å¯è¯»å±‚-CtpmvAQL.js";import{_ as c,r as o,o as u,c as b,f as e,g as n,i as a,w as r,e as i}from"./app-C9ZkQdtL.js";const m={},v=i('<h2 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€"><span>å‰è¨€</span></a></h2><p>ç°åœ¨æ˜¯å®¹å™¨åŒ–æ—¶ä»£ï¼Œä¸ç®¡æ˜¯å¼€å‘ã€æµ‹è¯•è¿˜æ˜¯è¿ç»´ï¼Œå¾ˆå°‘æœ‰äººä¼šä¸çŸ¥é“æˆ–ä¸ä¼šç”¨ Dockerã€‚ä½¿ç”¨ Docker ä¹Ÿå¾ˆç®€å•ï¼Œå¾ˆå¤šæ—¶å€™å¯åŠ¨å®¹å™¨æ— éå°±æ˜¯æ‰§è¡Œ <code>docker run {your-image-name}</code>ï¼Œè€Œæ„å»ºé•œåƒä¹Ÿå°±æ˜¯æ‰§è¡Œä¸€å¥ <code>docker build dockerfile .</code>çš„äº‹æƒ…ã€‚<br> ä¹Ÿè®¸æ­£æ˜¯ç”±äº <strong>Docker</strong> å¯¹å®ç°ç»†èŠ‚å°è£…å¾—è¿‡äºå½»åº•ï¼Œæœ‰æ—¶å€™ä¼šè§‰å¾—æˆ‘ä»¬ä¹Ÿè®¸åªæ˜¯å­¦ä¼šäº†<strong>å¦‚ä½•ä½¿ç”¨<code>Docker CLI</code></strong> , è€Œå¹¶éæ˜ç™½ Docker æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚<br> ç¬”è€…å°†åœ¨ã€How To Run Containerã€ç³»åˆ—æ–‡ç« è®²è¿° <code>docker run {your-image-name}</code> ç›¸å…³çš„å®ç°ç»†èŠ‚ï¼Œæœ¬æ–‡æ˜¯æœ¬ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œå°†ä¸ºå„ä½ä»‹ç»ä»é•œåƒåˆ›å»ºå®¹å™¨æ¶‰åŠåˆ°çš„å®ç°ç»†èŠ‚ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨"><span>ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨ï¼Ÿ</span></a></h2><h3 id="_1-ä»€ä¹ˆæ˜¯é•œåƒ" tabindex="-1"><a class="header-anchor" href="#_1-ä»€ä¹ˆæ˜¯é•œåƒ"><span>1. ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿ</span></a></h3>',4),h=e("code",null,"é•œåƒ",-1),p=e("strong",null,"å­˜å‚¨äº†æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿçš„å˜æ›´å†å²",-1),g=i(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.
â”œâ”€â”€ 036a82c6d65f2fa43a13599661490be3fca1c3d6790814668d4e8c0213153b12
â”‚Â Â  â”œâ”€â”€ VERSION
â”‚Â Â  â”œâ”€â”€ json
â”‚Â Â  â””â”€â”€ layer.tar
â”œâ”€â”€ f578fecf2875c8c4e4f88d15b90949fa40c71a0f0231b831f1263c708c2d524d
â”‚Â Â  â”œâ”€â”€ VERSION
â”‚Â Â  â”œâ”€â”€ json
â”‚Â Â  â””â”€â”€ layer.tar
â”œâ”€â”€ 6ad733544a6317992a6fac4eb19fe1df577d4dec7529efec28a5bd0edad0fd30.json
â”œâ”€â”€ manifest.json
â””â”€â”€ repositories
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿçš„å˜æ›´æ—¶, é•œåƒ(Image) å°†<strong>ä¸€ç»„æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´å†å²</strong>å®šä¹‰ä¸º<code>ã€Œé•œåƒå±‚(Image Layer)ã€</code>, æ¯ä¸ªé•œåƒå±‚è´Ÿè´£è®°å½•è¯¥å±‚é•œåƒä¸ä¸Šä¸€å±‚é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„å·®å¼‚, è€Œè¿™äº›é•œåƒå±‚ä¹‹é—´çš„å…³ç³»åˆ™ç”±<code>é•œåƒæ¸…å•(Image manifest)</code>è´Ÿè´£ç»´æŠ¤ã€‚<br> ç»¼ä¸Šæ‰€è¿°, <strong>é•œåƒå¯ä»¥ç®€å•åœ°ç†è§£æˆç”±å¤šä¸ªé•œåƒå±‚å åŠ èµ·æ¥çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ã€‚(å¦‚ä¸‹å›¾)</p><div class="language-plantuml line-numbers-mode" data-ext="plantuml" data-title="plantuml"><pre class="language-plantuml"><code><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIf8JCvEJ4zLyCm5ajLS2a2GbfcJgl1owfodpVtFThG-xPsABlgojVVvtdLWKJ01D2epBJ6vHC4diJAro12Re14sGJy5Bf0eJ9kDdXvKiPN2YsLjpsTFGv8sGaZxmQLhkHnIyrA0tW00
"></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),f=i('<h3 id="_2-ä»€ä¹ˆæ˜¯å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_2-ä»€ä¹ˆæ˜¯å®¹å™¨"><span>2.ä»€ä¹ˆæ˜¯å®¹å™¨ï¼Ÿ</span></a></h3><p>æ ¹æ® OCI çš„å®šä¹‰, <code>å®¹å™¨</code>æ˜¯ä¸€ä¸ªå¯é…ç½®<strong>èµ„æºé™åˆ¶</strong>å’Œ<strong>éš”ç¦»æ€§</strong>çš„, ç”¨äº<strong>æ‰§è¡Œè¿›ç¨‹çš„ç¯å¢ƒ</strong>ã€‚æˆ‘ä»¬çŸ¥é“, <code>Linux å®¹å™¨</code>çš„<strong>èµ„æºé™åˆ¶</strong>å’Œ<strong>éš”ç¦»æ€§</strong>æ˜¯åˆ†åˆ«åŸºäº <code>Cgroup</code> å’Œ <code>Linux Namespace</code> å®ç°çš„, ä¸¤è€…éƒ½æ˜¯ Linux å†…æ ¸æä¾›çš„åŠŸèƒ½, å…¶ä¸­ Cgroup ç”¨äºé™åˆ¶å’Œéš”ç¦»ä¸€ç»„è¿›ç¨‹å¯¹ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨, è€Œ Linux Namespace å¯¹å†…æ ¸èµ„æº(IPCã€Networkã€Mountã€PIDã€UTS å’Œ User)è¿›è¡Œäº†å°è£…, ä½¿å¾—ä¸åŒè¿›ç¨‹åœ¨å„è‡ªçš„ Namespace ä¸‹æ“ä½œåŒä¸€ç§èµ„æºæ—¶, ä¸ä¼šå½±å“ Namespace ä¸‹çš„è¿›ç¨‹ã€‚<br><code>å®¹å™¨</code>å’Œ<code>é•œåƒ</code>çš„å…³ç³»å°±åƒæ˜¯æ¨¡æ¿å’Œå®ä¾‹, é•œåƒæä¾›äº†<strong>è¿è¡Œå®¹å™¨çš„å¿…è¦å…ƒç´ (æ–‡ä»¶ç³»ç»Ÿå’Œè¿è¡Œé…ç½®)</strong>ï¼Œä½†ä¸ä¾èµ–é•œåƒä¹Ÿå¯è¿è¡Œå®¹å™¨, ç®€è€Œè¨€ä¹‹, æˆ‘ä»¬å¯ä»¥è®¤ä¸º<strong>é•œåƒæ˜¯å®¹å™¨çš„å……åˆ†ä¸å¿…è¦æ¡ä»¶</strong>ã€‚</p>',2),y=e("strong",null,"å¦‚ä½•ä½¿ç”¨é•œåƒè¿è¡Œå®¹å™¨",-1),E=e("strong",null,"å¦‚ä½•åœ¨ä¸ä¾èµ–é•œåƒçš„å‰æä¸‹, æ„å»ºå®¹å™¨è¿è¡Œè¦ç´ å¹¶è¿è¡Œå®¹å™¨",-1),_=i(`<h2 id="docker-æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#docker-æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨"><span>Docker æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨ï¼Ÿ</span></a></h2><p>æ­£å¦‚å‰æ–‡æ‰€è¨€, <code>é•œåƒ</code>æ˜¯ä¸€ä¸ª<strong>å­˜å‚¨äº†æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿçš„å˜æ›´å†å²</strong>çš„å½’æ¡£åŒ…, è€Œ<code>å®¹å™¨</code>æ˜¯ä¸€ä¸ªå¯é…ç½®<strong>èµ„æºé™åˆ¶</strong>å’Œ<strong>éš”ç¦»æ€§</strong>çš„, ç”¨äº<strong>æ‰§è¡Œè¿›ç¨‹çš„ç¯å¢ƒ</strong>ã€‚ä»æœ¬è´¨è€Œè¨€, é•œåƒä¸ºå®¹å™¨æä¾›äº†æ–‡ä»¶ç³»ç»Ÿå’Œè¿è¡Œå‚æ•°é…ç½®, è€Œå®¹å™¨åˆ™æ˜¯ä»é•œåƒåˆ›å»ºå‡ºæ¥çš„ä¸€ä¸ªå®ä¾‹ã€‚<br> æ¥ä¸‹æ¥, æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Docker ä»é•œåƒåˆ›å»ºå‡ºå®¹å™¨çš„å®ç°ç»†èŠ‚ã€‚</p><h3 id="é•œåƒå­˜å‚¨å’Œ-unionfs" tabindex="-1"><a class="header-anchor" href="#é•œåƒå­˜å‚¨å’Œ-unionfs"><span>é•œåƒå­˜å‚¨å’Œ UnionFS</span></a></h3><p>Docker é•œåƒåˆ†å±‚çš„å­˜å‚¨è®¾è®¡å€Ÿé‰´è‡ª UnionFSã€‚UnionFS æ˜¯ä¸€ç§å¯ä»¥å°†å¤šä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½•è”åˆæŒ‚è½½, å½¢æˆä¸€ä¸ªç»Ÿä¸€çš„, å±è”½åº•å±‚ç»†èŠ‚çš„æ–‡ä»¶ç³»ç»Ÿçš„æŠ€æœ¯ã€‚<br> Docker é•œåƒä¸­æ¯ä¸ªé•œåƒå±‚éƒ½æ˜¯ä¸€ä¸ª<strong>ä¸å®Œæ•´</strong>çš„æ–‡ä»¶ç³»ç»Ÿ, å®ƒè®°å½•è¯¥å±‚é•œåƒä¸ä¸Šä¸€å±‚é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„å·®å¼‚ã€‚è¿™ç§åˆ†å±‚ç­–ç•¥èµ‹äºˆäº† Docker æ›´è½»é‡çš„é•œåƒ(ç›¸å¯¹äºè™šæ‹Ÿæœºè€Œè¨€), åˆ†å‘é•œåƒæ—¶åªéœ€è¦ä¸‹è½½å¯¹åº”çš„é•œåƒå±‚å³å¯ã€‚<br> å½“ç„¶, è¿™ç§åˆ†å±‚é•œåƒè®¾è®¡ä¹Ÿå¼•å…¥äº†ä¸€ä¸ªéš¾é¢˜, <strong>å¦‚ä½•åˆ é™¤ä¸Šå±‚é•œåƒçš„æ–‡ä»¶?</strong><br> å¯¹äºè¿™ä¸ªé—®é¢˜, Docker ä¹Ÿæ˜¯åŸå°ä¸åŠ¨åœ°å¼•å…¥äº† UnionFS çš„è§£å†³æ–¹æ¡ˆ: <code>Whiteout</code> å’Œ<code> Opaque</code>ã€‚</p><h4 id="whiteout" tabindex="-1"><a class="header-anchor" href="#whiteout"><span>Whiteout</span></a></h4><p>æ‰€è°“çš„ <code>Whiteout</code> å’Œ<code> Opaque Whiteout</code> æ˜¯å€Ÿé‰´è‡ª UnionFS åè®®, Docker é•œåƒé€šè¿‡çº¦å®šçš„æ–‡ä»¶å‘½åæ–¹å¼, æè¿°äº†ä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿéœ€è¦å±è”½ä¸Šå±‚æ–‡ä»¶ç³»ç»Ÿä¸­çš„å“ªäº›æ–‡ä»¶æˆ–ç›®å½•ã€‚ä¾‹å¦‚, ä»¥ä¸‹æ˜¯åŒ…å«å¤šä¸ªèµ„æºçš„åŸºç¡€å±‚:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>â¯ tree .
.
â””â”€â”€ a
    â”œâ”€â”€ b
    â”‚Â Â  â””â”€â”€ c
    â”‚Â Â      â”œâ”€â”€ bar
    â”‚Â Â      â””â”€â”€ foo
    â””â”€â”€ baz

3 directories, 3 files
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿå†…éœ€è¦åˆ é™¤ <code>a/b/c/foo</code> è¿™ä¸ªæ–‡ä»¶, é‚£ä¹ˆä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªä»¥ <code>.wh.&lt;filename&gt;</code> ä¸ºå‘½åçš„éšè—æ–‡ä»¶, å³ä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿåº”å½“å…·æœ‰ä»¥ä¸‹çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„:</p>`,8),k=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{bash:"",class:"language-bash"},[e("code",null,`â¯ tree . -a
.
â””â”€â”€ a
    â””â”€â”€ b
        â””â”€â”€ c
            â””â”€â”€ .wh.foo

3 directories, 1 file
`)]),e("div",{class:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br")]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),w=i('<h4 id="opaque-whiteout" tabindex="-1"><a class="header-anchor" href="#opaque-whiteout"><span>Opaque Whiteout</span></a></h4><p>é™¤äº†é€šè¿‡ <code>Whiteout</code> æè¿°åˆ é™¤å•ä¸ªæ–‡ä»¶çš„åè®®å¤–, è¿˜å¯ä»¥é€šè¿‡ <code>Opaque Whiteout</code> æè¿°åˆ é™¤æŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚<br> ä»¥ä¸Šé¢æåˆ°çš„åŸºç¡€æ–‡ä»¶ç³»ç»Ÿä¸ºä¾‹, å¦‚æœä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿå¸Œæœ›åˆ é™¤ <code>a</code> ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶, é‚£ä¹ˆä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿåˆ™éœ€è¦åœ¨ <code>a</code> ç›®å½•ä¸‹åˆ›å»ºå‘½åä¸º <code>.wh..wh..opq</code> çš„éšè—æ–‡ä»¶, å³ä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿåº”å½“å…·æœ‰ä»¥ä¸‹çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„:</p>',2),B=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{bash:"",class:"language-bash"},[e("code",null,`â¯ tree . -a
.
â””â”€â”€ a
    â””â”€â”€ .wh..wh..opq

1 directory, 1 file
`)]),e("div",{class:"highlight-lines"},[e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br")]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),q=e("p",null,[n("å½“ç„¶, æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ "),e("code",null,"Whiteout"),n(" è¾¾åˆ°ä¸ "),e("code",null,"Opaque Whiteout"),n(" ç­‰ä»·çš„æ•ˆæœ, ä¾‹å¦‚ä»¥ä¸Šé¢æåˆ°çš„åŸºç¡€æ–‡ä»¶ç³»ç»Ÿä¸ºä¾‹, æˆ‘ä»¬å¸Œæœ›åˆ é™¤ "),e("code",null,"a"),n(" ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶, è¿˜å¯ä»¥é‡‡ç”¨ä»¥ä¸‹çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„è·å¾—ç­‰ä»·çš„ç»“æœ:")],-1),x=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{bash:"",class:"language-bash"},[e("code",null,`â¯ tree . -a 
.
â””â”€â”€ a
    â”œâ”€â”€ .wh.b
    â””â”€â”€ .wh.baz

1 directory, 2 files
`)]),e("div",{class:"highlight-lines"},[e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("div",{class:"highlight-line"},"Â "),e("br"),e("br")]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),D=i('<blockquote><p>å€¼å¾—æ³¨å…¥çš„æ˜¯: å¦‚ <code>Opaque Whiteout</code> ä¸åŒçš„æ˜¯, å¦‚æœ <code>a</code> ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ªæ–°çš„æ–‡ä»¶æˆ–ç›®å½•, é‚£ä¹ˆé€šè¿‡ <code>Whiteout</code> åˆ é™¤ <code>a</code> ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ™éœ€è¦ä¸ºè¿™ä¸ªæ–°çš„æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºæ–°çš„ <code>Whiteout</code> éšè—æ–‡ä»¶, è€Œä½¿ç”¨ <code>Opaque Whiteout</code> åˆ™ä¸éœ€è¦ã€‚</p></blockquote><h3 id="readonly-copy-on-write" tabindex="-1"><a class="header-anchor" href="#readonly-copy-on-write"><span>ReadOnly &amp; Copy on Write</span></a></h3><h4 id="readonly-layer" tabindex="-1"><a class="header-anchor" href="#readonly-layer"><span>ReadOnly Layer</span></a></h4><p>Docker åœ¨ UnionFS çš„åŸºç¡€ä¸Šè®¾è®¡äº†é•œåƒå†…å®¹(æ–‡ä»¶ç³»ç»Ÿå˜æ›´å†å²)çš„å­˜å‚¨æ–¹æ¡ˆ, åŒæ—¶åˆå¢åŠ äº†ä¸€ä¸ªé™åˆ¶: <strong>æ‰€æœ‰é•œåƒå±‚åªè¯», ä¸å…è®¸æ›´æ”¹é•œåƒå±‚å†…å®¹</strong>ã€‚</p><p>è¿™ä¸ªé™åˆ¶ä¸ä½†é¿å…äº†å®¹å™¨å†…å®¹åœ¨è¿è¡Œæ—¶å‡ºç°æ„å¤–å˜æ›´<sup>æ³¨</sup>, è€Œä¸”ä½¿å¾—å®¹å™¨é•œåƒæ¯”è™šæ‹Ÿæœºè€Œè¨€æ›´åŠ è½»é‡ã€‚</p><blockquote><p>æ³¨: è¯•æƒ³ä¸‹, å¦‚æœä¸Šå±‚æ–‡ä»¶ç³»ç»Ÿå†…å®¹å˜æ›´å, è”åˆæŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦éœ€è¦åŒæ­¥å˜æ›´å†…å®¹ï¼Ÿ</p></blockquote><figure><img src="'+d+`" alt="é•œåƒå±‚åªè¯»æ ·ä¾‹(ä»¥ ubuntu é•œåƒä¸ºä¾‹)" tabindex="0" loading="lazy"><figcaption>é•œåƒå±‚åªè¯»æ ·ä¾‹(ä»¥ ubuntu é•œåƒä¸ºä¾‹)</figcaption></figure><p>åŸºäº Docker å‡ºè‰²çš„é•œåƒè®¾è®¡æ–¹æ¡ˆ, ä½¿å¾—æ¯å°ä¸»æœºåªéœ€è¦ä¸ºæ¯ä¸ªé•œåƒå±‚å­˜å‚¨ä¸€ä¸ªå‰¯æœ¬, åŒæ—¶åœ¨åˆ†å‘é•œåƒæ—¶ä¹Ÿåªéœ€ä¸‹è½½ç¼ºå¤±çš„é•œåƒå±‚å†…å®¹, è¿™å¤§å¤§èŠ‚çœäº†å­˜å‚¨å’Œç½‘ç»œå¸¦å®½ã€‚</p><p>æ¥ä¸‹æ¥, é‚£ä¹ˆå®¹å™¨å¦‚ä½•åœ¨åªè¯»çš„é•œåƒå±‚å¢åˆ å†…å®¹å‘¢ï¼Ÿè¿™å°±ä¸å¾—ä¸ä»‹ç»å¦ä¸€ä¸ªæŠ€æœ¯: <strong>Copy-on-Write</strong></p><h4 id="copy-on-write" tabindex="-1"><a class="header-anchor" href="#copy-on-write"><span>Copy-on-Write</span></a></h4><p><strong>Copy-on-Write(ç®€ç§°, Cow)</strong> å®é™…ä¸Šæ˜¯ä¸€ç§è®¡ç®—æœºç¨‹åºè®¾è®¡é¢†åŸŸçš„ä¼˜åŒ–ç­–ç•¥, é¡¾åæ€ä¹‰, å¦‚æœæœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶è¯·æ±‚ç›¸åŒçš„èµ„æºæ—¶(å¦‚å†…å­˜æˆ–ç£ç›˜ä¸Šçš„æ•°æ®), ä»–ä»¬é¦–å…ˆä¼šè·å¾—æŒ‡å‘ç›¸åŒèµ„æºçš„åœ°å€, ç›´åˆ°æŸä¸ªç”¨æˆ·è§†å›¾ä¿®æ”¹èµ„æºçš„å†…å®¹æ—¶, ç³»ç»Ÿæ‰ä¼šçœŸæ­£å¤åˆ¶ä¸€ä»½ä¸“å±å‰¯æœ¬ç»™è¯¥ç”¨æˆ·, è€Œå…¶ä»–ç”¨æˆ·æ‰€è®¿é—®çš„èµ„æºä»ç„¶ä¿æŒä¸å˜ã€‚</p><div class="language-plantuml line-numbers-mode" data-ext="plantuml" data-title="plantuml"><pre class="language-plantuml"><code><img src="https://www.plantuml.com/plantuml/svg/X96rTMKn441pLJ7PhkdbPaigmHLyPZP3P6PcPsPcXceUTc7HPyhctA4xPteoVQvqNtyiYb3Kv--3lWIaGu5W7tX3QP-dBvI8eqma54-wqguO95sUY2lWw-qRZlg0frtnGDI7N9w-H1hwCxuqBeW9GhaIi5ycpSzL64K0_t43QF2VDF2OPkFnmcfiRPwRis_MnQUpyooQU9inTsSUNZU0AmCOIqRCnHbdVLOo8XajP5JrifsTdNnr6nZ7IyRigprpgLA4AGY7Dd0sVitb4yMfv3J7Ynr9FKTImP5KS2GKgMObWajCieAbXbJUH6ZXKLnIV8BbkiJXRM3VVHdJUmfh6iU4zwnSiamHfdcCk0XqQ9fyPevpZugOCiny55OxKOylxlqRC7K10000
"></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å®¹å™¨å¼•å…¥Cow(ğŸ‚)æŠ€æœ¯, é€šè¿‡<strong>å»¶è¿Ÿæ‹·è´</strong>çš„æ–¹å¼èŠ‚çœäº†åˆ›å»ºå¤šä¸ªå®Œæ•´å‰¯æœ¬æ—¶å¸¦æ¥çš„ç©ºé—´å’Œæ—¶é—´ä¸Šçš„å¼€é”€ã€‚è¯¥æŠ€æœ¯åœ¨å®¹å™¨ä¸Šåˆ™è¡¨ç°ä¸ºæ¯ä¸ªå®¹å™¨åœ¨ UnionFS çš„åŸºç¡€ä¸Šå¢åŠ äº†å„è‡ªçš„è¯»å†™å±‚(R/W Layer), è¯¥å±‚ä¸­çš„æ‰€æœ‰å†…å®¹å³æ˜¯è¯¥å®¹å™¨çš„æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿå˜æ›´<sup>æ³¨</sup>ã€‚</p><blockquote><p>æ³¨: å€ŸåŠ© Cow æŠ€æœ¯, æ„å»ºé•œåƒæ—¶åªéœ€è¦å°†æ¯å±‚é•œåƒçš„è¯»å†™å±‚å½’æ¡£æˆé•œåƒå±‚å³å¯ã€‚</p></blockquote><figure><img src="`+t+'" alt="å®¹å™¨å¯è¯»å±‚(ä»¥ ubuntu é•œåƒä¸ºä¾‹)" tabindex="0" loading="lazy"><figcaption>å®¹å™¨å¯è¯»å±‚(ä»¥ ubuntu é•œåƒä¸ºä¾‹)</figcaption></figure><h2 id="å®æˆ˜-åŸºäº-overlayfs2-å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜-åŸºäº-overlayfs2-å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨"><span>å®æˆ˜: åŸºäº OverlayFS2, å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨</span></a></h2>',16),C=i('<ol><li>å°†å®¹å™¨ç¼–æ’ä¸ºæ–‡ä»¶ç³»ç»Ÿæ†ç»‘åŒ…(Filesystem Bundle)çš„å½¢å¼</li><li>å¾€ <code>config.json</code> ç¼–å†™æ­£ç¡®çš„é…ç½®</li><li>å¾€ <code>$root.path</code> å¡«å……åˆç†å’Œå¯ç”¨çš„æ–‡ä»¶</li><li>æ‰§è¡Œ runc run $containerid å¯åŠ¨å®¹å™¨</li></ol><p>ä½†æ˜¯å¦‚ä¸Šä¸€ç¯‡æ–‡ç« ä¸åŒçš„æ˜¯, æˆ‘ä»¬è¿™æ¬¡ä¸å†æ˜¯å¾’æ‰‹æ„å»º Docker é•œåƒ, è€Œæ˜¯ä» DockerHub ä¸­è·å–é•œåƒï¼Œå……åˆ†æ¨¡æ‹Ÿ <code>docker run {your-image-name}</code> æ¶‰åŠçš„æµç¨‹ã€‚</p><h3 id="_1-è·å–é•œåƒ" tabindex="-1"><a class="header-anchor" href="#_1-è·å–é•œåƒ"><span>1. è·å–é•œåƒ</span></a></h3>',3),A={href:"https://raw.githubusercontent.com/moby/moby/master/contrib/download-frozen-image-v2.sh",target:"_blank",rel:"noopener noreferrer"},F=e("code",null,"Token è®¤è¯",-1),R=e("code",null,"æ‹‰å–é•œåƒæ¸…å•",-1),S=e("code",null,"æ‹‰å–é•œåƒå±‚",-1),O=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{bash:"",class:"language-bash"},[e("code",null,`â¯ ./download-frozen-image-v2.sh -h
usage: ./download-frozen-image-v2.sh dir image[:tag][@digest] ...
       ./download-frozen-image-v2.sh /tmp/old-hello-world hello-world:latest@sha256:8be990ef2aeb16dbcb9271ddfe2610fa6658d13f6dfb8bc72074cc1ca36966a7

â¯ ./download-frozen-image-v2.sh alpine alpine/git:v2.30.2
Downloading 'alpine/git:v2.30.2@v2.30.2' (3 layers)...
#=#=-  ##     #
############################################################################################################################################################################ 100.0%
#=#=-  ##     #
############################################################################################################################################################################ 100.0%
#=#=-  ##     #
############################################################################################################################################################################ 100.0%

Download of images into 'alpine' complete.
Use something like the following to load the result into a Docker daemon:
  tar -cC 'alpine' . | docker load

## æŸ¥çœ‹é•œåƒç»“æ„
â¯ tree alpine/
alpine/
â”œâ”€â”€ 09af0b97aec5975955488d528e8535d2678b75cb29adb6827abd85b52802d1b1
â”‚Â Â  â”œâ”€â”€ json
â”‚Â Â  â”œâ”€â”€ layer.tar
â”‚Â Â  â””â”€â”€ VERSION
â”œâ”€â”€ 86f68eb8bb2057574a5385c9ce7528b70632e1c750fb36d5ac76c0a5460f5d95
â”‚Â Â  â”œâ”€â”€ json
â”‚Â Â  â”œâ”€â”€ layer.tar
â”‚Â Â  â””â”€â”€ VERSION
â”œâ”€â”€ b86cef5f7cf032b9793fe2a4fb18ddf606df8ea9e41d4c2086749bf943c2985b.json
â”œâ”€â”€ d8aa90f099f0f17f3ad894f0909e6bfd026cc4c76eec03e3e50391af42f41976
â”‚Â Â  â”œâ”€â”€ json
â”‚Â Â  â”œâ”€â”€ layer.tar
â”‚Â Â  â””â”€â”€ VERSION
â”œâ”€â”€ manifest.json
â””â”€â”€ repositories

3 directories, 12 files
`)]),e("div",{class:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("div",{class:"highlight-line"},"Â "),e("br"),e("br"),e("br")]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),I=e("h3",{id:"_2-æ„å»º-overlay-æ–‡ä»¶ç³»ç»Ÿ",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_2-æ„å»º-overlay-æ–‡ä»¶ç³»ç»Ÿ"},[e("span",null,"2. æ„å»º Overlay æ–‡ä»¶ç³»ç»Ÿ")])],-1),T={href:"https://github.com/moby/moby/blob/master/daemon/graphdriver/overlay2/overlay.go",target:"_blank",rel:"noopener noreferrer"},W=i(`<blockquote><p>OverlayFS æ˜¯ä¸€ä¸ªä¸ AUFS ç±»ä¼¼çš„ä½†æ€§èƒ½æ›´å¿«, å®ç°æ›´ç®€å•çš„ç°ä»£è”åˆæ–‡ä»¶ç³»ç»Ÿ, å·²é›†æˆè‡³ linux 3.8 ä»¥ä¸Šç‰ˆæœ¬çš„å†…æ ¸ï¼Œæ˜¯ Docker æ¨èä½¿ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒçš„æ–‡ä»¶ç³»ç»Ÿã€‚</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## è§£å‹ç¼©é•œåƒå†…å®¹
### ç¡®å®šé•œåƒå±‚é¡ºåº
â¯ cat alpine/manifest.json
[
  {
    &quot;Config&quot;: &quot;b86cef5f7cf032b9793fe2a4fb18ddf606df8ea9e41d4c2086749bf943c2985b.json&quot;,
    &quot;RepoTags&quot;: [
      &quot;alpine/git:v2.30.2&quot;
    ],
    &quot;Layers&quot;: [
      &quot;86f68eb8bb2057574a5385c9ce7528b70632e1c750fb36d5ac76c0a5460f5d95/layer.tar&quot;,
      &quot;09af0b97aec5975955488d528e8535d2678b75cb29adb6827abd85b52802d1b1/layer.tar&quot;,
      &quot;d8aa90f099f0f17f3ad894f0909e6bfd026cc4c76eec03e3e50391af42f41976/layer.tar&quot;
    ]
  }
]

### åˆ›å»ºé•œåƒå±‚è§£å‹ç¼©çš„ç›®å½•
â¯ mkdir -p /tmp/overlay/image/1 /tmp/overlay/image/2 /tmp/overlay/image/3 

### è§£å‹é•œåƒå±‚å†…å®¹, å¹¶æŒ‰é¡ºåºè¿›è¡Œç¼–æ’
â¯ tar -C /tmp/overlay/image/1 -xf alpine/86f68eb8bb2057574a5385c9ce7528b70632e1c750fb36d5ac76c0a5460f5d95/layer.tar
â¯ tar -C /tmp/overlay/image/2 -xf alpine/09af0b97aec5975955488d528e8535d2678b75cb29adb6827abd85b52802d1b1/layer.tar 
â¯ tar -C /tmp/overlay/image/3 -xf alpine/d8aa90f099f0f17f3ad894f0909e6bfd026cc4c76eec03e3e50391af42f41976/layer.tar

## æ„å»º OverlayFS
### åˆ›å»ºæŒ‚è½½ç‚¹(ç©ºç›®å½•)
â¯ mkdir -p /tmp/overlay/container-a/merged /tmp/overlay/container-a/upperdir /tmp/overlay/container-a/workdir

### æŒ‚è½½é•œåƒæ–‡ä»¶ç³»ç»Ÿè‡³ /tmp/overlay/container-a/merged ç›®å½•, å…¶ä¸­é•œåƒçš„è¯»å†™å±‚å†…å®¹å­˜å‚¨åœ¨ /tmp/overlay/container-a/upperdir
â¯ cd /tmp/overlay/ &amp;&amp; \\
  mount -t overlay overlay \\
  -o lowerdir=image/1:image/2:image/3,upperdir=container-a/upperdir,workdir=container-a/workdir \\
  /tmp/overlay/container-a/merged

## éªŒè¯æŒ‚è½½è®°å½•
â¯ mount |grep overlay
overlay on /tmp/overlay/container-a/merged type overlay (rw,relatime,lowerdir=image/1:image/2:image/3,upperdir=container-a/upperdir,workdir=container-a/workdir)

## éªŒè¯è¯»å†™å±‚ä¸ä¼šå½±å“åº•å±‚æ–‡ä»¶ç³»ç»Ÿ
â¯ echo &quot;1&quot; &gt; /tmp/overlay/container-a/merged/a

## åªæœ‰è¯»å†™å±‚(upperdir)ä¼šè¢«å†™å…¥
â¯ cat /tmp/overlay/container-a/upperdir/a
1

## åº•å±‚æ–‡ä»¶ç³»ç»Ÿ(lowerdir)ä¸ä¼šè¢«ä¿®æ”¹
â¯ cat image/1/a
cat: image/1/a: No such file or directory
â¯ cat image/2/a
cat: image/2/a: No such file or directory
â¯ cat image/3/a
cat: image/3/a: No such file or directory

## ä½†æ˜¯, æŒ‚è½½åä¿®æ”¹åº•å±‚æ–‡ä»¶ç³»ç»Ÿåˆ™ä¼šä½“ç°åˆ°æŒ‚è½½çš„è”åˆæ–‡ä»¶ç³»ç»Ÿä¹‹ä¸­
â¯ echo &quot;2&quot; &gt; image/1/b
â¯ cat container-a/merged/b
2

## ç„¶ååœ¨ merged å±‚ä¸­åˆ é™¤ b, å†æŸ¥çœ‹è¯»å†™å±‚çš„å†…å®¹
â¯ rm container-a/merged/b &amp;&amp; ls -ahl container-a/upperdir
æ€»ç”¨é‡ 8.0K
drwxr-xr-x 2 root root 4.0K 8æœˆ  12 17:08 .
drwxr-xr-x 5 root root 4.0K 8æœˆ  12 12:05 ..
c--------- 1 root root 0, 0 8æœˆ  12 17:08 b

## éªŒè¯å¹¶ä¸å½±å“åº•å±‚çš„é•œåƒæ–‡ä»¶ç³»ç»Ÿ
â¯ cat image/1/b
2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-å¯åŠ¨å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_3-å¯åŠ¨å®¹å™¨"><span>3. å¯åŠ¨å®¹å™¨</span></a></h3><p>åœ¨æ­¥éª¤ 1,2 ä¸­ä»¥æˆåŠŸä»é•œåƒåˆ›å»ºå‡ºå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿ, ç°åœ¨åªéœ€è¦ä½¿ç”¨ runc å¯åŠ¨å³å¯ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>â¯ cd /tmp/overlay/container-a/

## åˆ›å»º config.json
â¯ runc spec

## å°† &quot;rootfs&quot; æ›¿æ¢æˆ &quot;merged&quot;, å³è®¾ç½®å®¹å™¨çš„å¯åŠ¨ç›®å½•åœ¨ merged
â¯ sed -i &quot;s/\\&quot;rootfs\\&quot;/\\&quot;merged\\&quot;/&quot; config.json
## å–æ¶ˆ readonly
â¯ sed -i &quot;s/\\&quot;readonly\\&quot;: true/\\&quot;readonly\\&quot;: false/&quot; config.json

## å¯åŠ¨ï¼
â¯ runc run container-a

## å°è¯•å†™å…¥æ–‡ä»¶
â¯ echo &quot;hello world&quot; &gt; container-a
â¯ cat container-a
hello world

## å®¹å™¨å¤–éªŒè¯æ–‡ä»¶æ˜¯å¦å†™å…¥æˆåŠŸ
â¯ cat cat upperdir/container-a
hello world
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_4-å°ç»“"><span>4. å°ç»“</span></a></h3><p>åˆ°è¿™é‡Œæˆ‘ä»¬æˆåŠŸä»é•œåƒåˆ›å»ºå‡ºå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿ, å¹¶æˆåŠŸå¯åŠ¨å®¹å™¨, æœ€åæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹, ä»é•œåƒåˆ›å»ºå®¹å™¨ååˆ†ç®€å•, åªéœ€è¦: 0. ç†Ÿæ‚‰ Docker Registry API V2 è§„èŒƒ, äº†è§£å¦‚ä½•ä» DocerHub ä¸‹è½½é•œåƒ(å¯é€‰, å¦‚æœå·²æœ‰é•œåƒåˆ™ä¸éœ€è¦)</p><ol><li>ç†Ÿæ‚‰ Docker é•œåƒè§„èŒƒ, äº†è§£å¦‚ä½•ä»é•œåƒè½¬æ¢æˆæ–‡ä»¶ç³»ç»Ÿ</li></ol><ul><li>å¦‚æœé•œåƒå†…å±è”½ä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿä¸­çš„å†…å®¹, é‚£ä¹ˆè¿˜éœ€è¦äº†è§£ä¸åŒ UnionFS å®ç° Whiteout çš„æ–¹å¼</li></ul><ol start="2"><li>ç†Ÿæ‚‰ OCI è¿è¡Œæ—¶è§„èŒƒ, äº†è§£å¦‚ä½•ä»æ ¹æ–‡ä»¶ç³»ç»Ÿå¯åŠ¨å®¹å™¨</li></ol><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h2><p>è¿™ç¯‡æ–‡ç« æ˜¯ã€How To Run Containerã€ç³»åˆ—çš„ç¬¬äºŒç¯‡ï¼Œä¸»è¦ä»¥ Docker é•œåƒè®¾è®¡ä¸ºåˆ‡å…¥ç‚¹, ä»‹ç»äº† Docker é•œåƒåˆ†å±‚è®¾è®¡æ˜¯å€Ÿé‰´äº Union FileSystemã€‚Docker åœ¨é¡¶å±‚è®¾è®¡ä¸Šè¦æ±‚é•œåƒä¸­æ¯å±‚çš„å†…å®¹åªå¢ä¸åˆ , ä½†ä¸Šå±‚æ–‡ä»¶ç³»ç»Ÿå¯å€ŸåŠ© <code>Whiteout åè®®</code> å±è”½ä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿä¸­çš„å†…å®¹ã€‚åŒæ—¶, å¾—ç›Šäº <code>Copy-on-Write(å†™å…¥æ—¶å¤åˆ¶)</code> æŠ€æœ¯, Docker ä¸ºæ¯ä¸ªå®¹å™¨åˆ†é…äº†å„è‡ªçš„å¯è¯»å†™çš„å±‚, ä½¿å¾—å®¹å™¨å¯¹é•œåƒå†…å®¹çš„ä¿®æ”¹äº’ä¸å¹²æ‰°, è€Œè¿™å®¹å™¨è¯»å†™å±‚äº¦è®°å½•äº†è¯¥å®¹å™¨çš„æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿå˜æ›´ã€‚æœ€å, è¿™ç¯‡æ–‡ç« è¿˜æ¼”ç¤ºäº†åœ¨ä¸ä¾èµ– Docker Engine çš„å‰æä¸‹, å¦‚ä½•ä»é•œåƒæ„é€ å‡ºå®¹å™¨æ ¹æ–‡ä»¶ç³»ç»Ÿå¹¶å¯åŠ¨å®¹å™¨ã€‚<br> åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²åŸºæœ¬æŒæ¡å®¹å™¨åŒ–æŠ€æœ¯æ¶‰åŠåˆ°çš„æ‰€æœ‰æŠ€æœ¯, æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« å°†å¸¦å¤§å®¶æ·±å…¥ Linux å†…æ ¸, æ¢ç´¢å®¹å™¨å®ç°<strong>èµ„æºé™åˆ¶</strong>å’Œ<strong>éš”ç¦»æ€§</strong>çš„ç»†èŠ‚ã€‚<br> ä½†åœ¨æ­¤ä¹‹å‰, ç¬”è€…å°†å…ˆç¼–å†™ã€How To Build Imagesã€ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç« , åœ¨æœªæ¥çš„è¿™ç¯‡æ–‡ç« ä¸­å°†ä¸å¤§å®¶æ·±å…¥æ¢è®¨ <code>Docker Daemon</code> ä¸ <code>Docker Registry</code> çš„äº¤äº’æµç¨‹, ä¸ºå¤§å®¶å‰–æéšè—åœ¨ <code>docker pull</code> ä¸ <code>docker push</code> èƒŒåçš„ç»†èŠ‚ã€‚</p>`,12);function P(N,j){const l=o("RouteLink"),s=o("ExternalLinkIcon");return u(),b("div",null,[v,e("p",null,[n("æ­£å¦‚æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« "),a(l,{to:"/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html"},{default:r(()=>[n("ã€Docker é•œåƒè§„èŒƒ v1.2ã€")]),_:1}),n("ä¸­æŒ‡å‡ºçš„, "),h,n("æ˜¯ä¸€ä¸ª"),p,n("çš„å½’æ¡£åŒ…ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä¸€ä¸ªåŸºæœ¬çš„é•œåƒå…·æœ‰ä»¥ä¸‹çš„ç›®å½•ç»“æ„:")]),g,e("blockquote",null,[e("p",null,[n("äº‹å®ä¸Š, é•œåƒå†…è¿˜è®°å½•äº†è¯¥é•œåƒçš„ä¸€äº›åŸºæœ¬ä¿¡æ¯, ä¾‹å¦‚åˆ›å»ºæ—¥æœŸ, ä½œè€…å’Œå…¶çˆ¶é•œåƒçš„ID, ä»¥åŠè¿è¡Œæ—¶çš„ç›¸å…³é…ç½®, å…³äºé•œåƒå†…å®¹æ›´è¯¦ç»†çš„æè¿°å¯å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« "),a(l,{to:"/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html"},{default:r(()=>[n("ã€Docker é•œåƒè§„èŒƒ v1.2ã€")]),_:1})])]),f,e("blockquote",null,[e("p",null,[n("å…³äºâ€œå……åˆ†ä¸å¿…è¦æ¡ä»¶â€, æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯»æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« "),a(l,{to:"/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html#%E7%85%A7%E7%8C%AB%E7%94%BB%E8%99%8E-%E6%9E%84%E5%BB%BA%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8%E6%8D%86%E7%BB%91%E5%8C%85"},{default:r(()=>[n("ã€ä» 0 å¼€å§‹å¸¦ä½ å¾’æ‰‹æ„å»º Docker é•œåƒã€")]),_:1}),n("ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­, æˆ‘å…ˆåä¸ºå¤§å®¶å±•ç¤ºäº†"),y,n("å’Œ"),E,n("ã€‚")])]),_,k,w,B,q,x,D,e("p",null,[n("ä½¿ç”¨ runc å¯åŠ¨å®¹å™¨çš„æµç¨‹å·²ç»åœ¨ä¸Šä¸€ç¯‡æ–‡ç« "),a(l,{to:"/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html"},{default:r(()=>[n("ã€ä» 0 å¼€å§‹å¸¦ä½ å¾’æ‰‹æ„å»º Docker é•œåƒã€")]),_:1}),n("å……åˆ†æ¼”ç¤º, è¿™é‡Œé‡æ–°å›é¡¾ä¸‹æµç¨‹, æƒ³è¦ç›´æ¥è¿è¡Œå®¹å™¨ååˆ†ç®€å•, åªéœ€è¦:")]),C,e("p",null,[n("æˆ‘ä»¬çŸ¥é“, DockerHub å¹¶ä¸éœ€è¦ Docker Engine å³å¯è®¿é—®, å…¶æ¥å£è§„èŒƒéµå¾ª Docker Registry API V2ã€‚ä¹Ÿå°±æ˜¯è¯´, æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ REST API å³å¯ä» DockerHub è·å–é•œåƒã€‚è¿™é‡Œä½¿ç”¨åˆ°ä¸€ä¸ªå¼€æºè„šæœ¬"),e("a",A,[n("download-frozen-image-v2.sh"),a(s)]),n(", è¯¥è„šæœ¬ä½¿ç”¨ curl, jq ç­‰å·¥å…·å®ç°äº†"),F,n(", "),R,n(", "),S,n(" ç­‰æµç¨‹, ä¸‹é¢æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¯¥è„šæœ¬æ‹‰å– alpine/git:v2.30.2 é•œåƒ")]),O,I,e("p",null,[n("åœ¨è·å–åˆ°é•œåƒä¹‹å, æˆ‘ä»¬åˆ™å¯ä»¥å¼€å§‹å°†é•œåƒå†…å®¹ç¼–æ’ä¸ºæ–‡ä»¶ç³»ç»Ÿæ†ç»‘åŒ…(Filesystem Bundle)çš„å½¢å¼, è¿™é‡Œæ ¹æ® "),e("a",T,[n("Docker Overlay2 Driver"),a(s)]),n(" çš„æµç¨‹æ¥æ„å»ºå®¹å™¨çš„ rootfsã€‚")]),W])}const H=c(m,[["render",P],["__file","how-to-run-container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚.html.vue"]]),V=JSON.parse('{"path":"/posts/2021/08/12/how-to-run-container-%E6%B5%85%E8%B0%88%E4%BB%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html","title":"How To Run Container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚","lang":"zh-CN","frontmatter":{"draft":false,"permalinkPattern":"/posts/:year/:month/:day/:slug.html","type":"post","filePathRelative":"_posts/container/2021-07-17-How To Run Container- æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚.md","date":"2021-08-12T00:00:00.000Z","title":"How To Run Container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚","sidebarDepth":2,"category":"å®¹å™¨æŠ€æœ¯","tags":["docker","container"],"description":"å‰è¨€ ç°åœ¨æ˜¯å®¹å™¨åŒ–æ—¶ä»£ï¼Œä¸ç®¡æ˜¯å¼€å‘ã€æµ‹è¯•è¿˜æ˜¯è¿ç»´ï¼Œå¾ˆå°‘æœ‰äººä¼šä¸çŸ¥é“æˆ–ä¸ä¼šç”¨ Dockerã€‚ä½¿ç”¨ Docker ä¹Ÿå¾ˆç®€å•ï¼Œå¾ˆå¤šæ—¶å€™å¯åŠ¨å®¹å™¨æ— éå°±æ˜¯æ‰§è¡Œ docker run {your-image-name}ï¼Œè€Œæ„å»ºé•œåƒä¹Ÿå°±æ˜¯æ‰§è¡Œä¸€å¥ docker build dockerfile .çš„äº‹æƒ…ã€‚ ä¹Ÿè®¸æ­£æ˜¯ç”±äº Docker å¯¹å®ç°ç»†èŠ‚å°è£…å¾—è¿‡äºå½»åº•ï¼Œæœ‰æ—¶å€™...","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://blog.shabbywu.cn/en/posts/2021/08/12/how-to-run-container-%E6%B5%85%E8%B0%88%E4%BB%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html"}],["meta",{"property":"og:url","content":"https://blog.shabbywu.cn/posts/2021/08/12/how-to-run-container-%E6%B5%85%E8%B0%88%E4%BB%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html"}],["meta",{"property":"og:site_name","content":"ä¸ªäººæŠ€æœ¯æ–‡ç« åˆ†äº«"}],["meta",{"property":"og:title","content":"How To Run Container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚"}],["meta",{"property":"og:description","content":"å‰è¨€ ç°åœ¨æ˜¯å®¹å™¨åŒ–æ—¶ä»£ï¼Œä¸ç®¡æ˜¯å¼€å‘ã€æµ‹è¯•è¿˜æ˜¯è¿ç»´ï¼Œå¾ˆå°‘æœ‰äººä¼šä¸çŸ¥é“æˆ–ä¸ä¼šç”¨ Dockerã€‚ä½¿ç”¨ Docker ä¹Ÿå¾ˆç®€å•ï¼Œå¾ˆå¤šæ—¶å€™å¯åŠ¨å®¹å™¨æ— éå°±æ˜¯æ‰§è¡Œ docker run {your-image-name}ï¼Œè€Œæ„å»ºé•œåƒä¹Ÿå°±æ˜¯æ‰§è¡Œä¸€å¥ docker build dockerfile .çš„äº‹æƒ…ã€‚ ä¹Ÿè®¸æ­£æ˜¯ç”±äº Docker å¯¹å®ç°ç»†èŠ‚å°è£…å¾—è¿‡äºå½»åº•ï¼Œæœ‰æ—¶å€™..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://blog.shabbywu.cn/img/é•œåƒå±‚åªè¯»æ ·ä¾‹.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-03-10T10:48:22.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"How To Run Container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚"}],["meta",{"property":"article:author","content":"shabbywu"}],["meta",{"property":"article:tag","content":"docker"}],["meta",{"property":"article:tag","content":"container"}],["meta",{"property":"article:published_time","content":"2021-08-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-10T10:48:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"How To Run Container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚\\",\\"image\\":[\\"https://blog.shabbywu.cn/img/é•œåƒå±‚åªè¯»æ ·ä¾‹.png\\",\\"https://blog.shabbywu.cn/img/å®¹å™¨å¯è¯»å±‚.jpg\\"],\\"datePublished\\":\\"2021-08-12T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-10T10:48:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"shabbywu\\",\\"url\\":\\"https://github.com/shabbywu\\"}]}"],["link",{"rel":"alternate","type":"application/atom+xml","href":"https://blog.shabbywu.cn/atom.xml","title":"ä¸ªäººæŠ€æœ¯æ–‡ç« åˆ†äº« Atom Feed"}],["link",{"rel":"alternate","type":"application/json","href":"https://blog.shabbywu.cn/feed.json","title":"ä¸ªäººæŠ€æœ¯æ–‡ç« åˆ†äº« JSON Feed"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://blog.shabbywu.cn/rss.xml","title":"ä¸ªäººæŠ€æœ¯æ–‡ç« åˆ†äº« RSS Feed"}]]},"headers":[{"level":2,"title":"å‰è¨€","slug":"å‰è¨€","link":"#å‰è¨€","children":[]},{"level":2,"title":"ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨ï¼Ÿ","slug":"ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨","link":"#ä»€ä¹ˆæ˜¯é•œåƒå’Œå®¹å™¨","children":[{"level":3,"title":"1. ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿ","slug":"_1-ä»€ä¹ˆæ˜¯é•œåƒ","link":"#_1-ä»€ä¹ˆæ˜¯é•œåƒ","children":[]},{"level":3,"title":"2.ä»€ä¹ˆæ˜¯å®¹å™¨ï¼Ÿ","slug":"_2-ä»€ä¹ˆæ˜¯å®¹å™¨","link":"#_2-ä»€ä¹ˆæ˜¯å®¹å™¨","children":[]}]},{"level":2,"title":"Docker æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨ï¼Ÿ","slug":"docker-æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨","link":"#docker-æ˜¯å¦‚ä½•ä»é•œåƒåˆ›å»ºå®¹å™¨","children":[{"level":3,"title":"é•œåƒå­˜å‚¨å’Œ UnionFS","slug":"é•œåƒå­˜å‚¨å’Œ-unionfs","link":"#é•œåƒå­˜å‚¨å’Œ-unionfs","children":[]},{"level":3,"title":"ReadOnly & Copy on Write","slug":"readonly-copy-on-write","link":"#readonly-copy-on-write","children":[]}]},{"level":2,"title":"å®æˆ˜: åŸºäº OverlayFS2, å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨","slug":"å®æˆ˜-åŸºäº-overlayfs2-å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨","link":"#å®æˆ˜-åŸºäº-overlayfs2-å¾’æ‰‹ä»é•œåƒåˆ›å»ºå®¹å™¨","children":[{"level":3,"title":"1. è·å–é•œåƒ","slug":"_1-è·å–é•œåƒ","link":"#_1-è·å–é•œåƒ","children":[]},{"level":3,"title":"2. æ„å»º Overlay æ–‡ä»¶ç³»ç»Ÿ","slug":"_2-æ„å»º-overlay-æ–‡ä»¶ç³»ç»Ÿ","link":"#_2-æ„å»º-overlay-æ–‡ä»¶ç³»ç»Ÿ","children":[]},{"level":3,"title":"3. å¯åŠ¨å®¹å™¨","slug":"_3-å¯åŠ¨å®¹å™¨","link":"#_3-å¯åŠ¨å®¹å™¨","children":[]},{"level":3,"title":"4. å°ç»“","slug":"_4-å°ç»“","link":"#_4-å°ç»“","children":[]}]},{"level":2,"title":"æ€»ç»“","slug":"æ€»ç»“","link":"#æ€»ç»“","children":[]}],"readingTime":{"minutes":13.19,"words":3958},"filePathRelative":"_posts/container/2021-07-17-how-to-run-container-æµ…è°ˆä»é•œåƒåˆ›å»ºå®¹å™¨çš„å®ç°ç»†èŠ‚.md","localizedDate":"2021å¹´8æœˆ12æ—¥","autoDesc":true,"git":{"createdTime":1708758647000,"updatedTime":1710067702000,"contributors":[{"name":"shabbywu","email":"shabbywu@tencent.com","commits":2}]}}');export{H as comp,V as data};
