<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.26" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="zh-cn" href="https://blog.shabbywu.cn/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html"><meta property="og:url" content="https://blog.shabbywu.cn/en/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html"><meta property="og:site_name" content="Personal technical article sharing"><meta property="og:title" content="How To Build Images:Docker Image Specification v1.2"><meta property="og:description" content="Preface We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is a..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:locale:alternate" content="zh-CN"><meta property="og:updated_time" content="2024-03-10T11:33:17.000Z"><meta property="article:author" content="shabbywu"><meta property="article:tag" content="docker"><meta property="article:tag" content="build"><meta property="article:published_time" content="2021-01-31T00:00:00.000Z"><meta property="article:modified_time" content="2024-03-10T11:33:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"How To Build Images:Docker Image Specification v1.2","image":[""],"datePublished":"2021-01-31T00:00:00.000Z","dateModified":"2024-03-10T11:33:17.000Z","author":[{"@type":"Person","name":"shabbywu","url":"https://github.com/shabbywu"}]}</script><link rel="alternate" type="application/atom+xml" href="https://blog.shabbywu.cn/en/atom.xml" title="Personal technical article sharing Atom Feed"><link rel="alternate" type="application/json" href="https://blog.shabbywu.cn/en/feed.json" title="Personal technical article sharing JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://blog.shabbywu.cn/en/rss.xml" title="Personal technical article sharing RSS Feed"><link rel="icon" href="/img/avatar.png"><title>How To Build Images:Docker Image Specification v1.2 | Personal technical article sharing</title><meta name="description" content="Preface We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is a...">
    <link rel="preload" href="/assets/app-XpSQsho0.css" as="style"><link rel="stylesheet" href="/assets/app-XpSQsho0.css">
    <link rel="modulepreload" href="/assets/app-iv9USOQR.js"><link rel="modulepreload" href="/assets/how-to-build-images-docker-镜像规范.html-D6Vm85Yg.js">
    <link rel="prefetch" href="/assets/index.html-Dw2tmnsH.js" as="script"><link rel="prefetch" href="/assets/index.html-BvujOger.js" as="script"><link rel="prefetch" href="/assets/index.html-CHIm7Skv.js" as="script"><link rel="prefetch" href="/assets/git-merge-method.html-Btz9b4PY.js" as="script"><link rel="prefetch" href="/assets/git-merge-conflicts.html-BrvyetYl.js" as="script"><link rel="prefetch" href="/assets/记一次时区异常问题排查思路和过程.html-DjKs_-jI.js" as="script"><link rel="prefetch" href="/assets/oauth-client-server-side-apps.html-BRCF90Y4.js" as="script"><link rel="prefetch" href="/assets/oauth-client-client-side-apps.html-C4Piky4R.js" as="script"><link rel="prefetch" href="/assets/how-to-build-images-docker-镜像规范.html-DEm1k-_t.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-oci-运行时规范.html-DCqyGvM6.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-从-0-开始带你徒手构建-docker-镜像.html-CjdsXfqT.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-浅谈从镜像创建容器的实现细节.html-BmKHEKnT.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-手把手教你如何推镜像至-docker-registry.html-ycRgd3B9.js" as="script"><link rel="prefetch" href="/assets/wasm-or-container.html-BC2RJBme.js" as="script"><link rel="prefetch" href="/assets/c-tmp-exercise.html-DCEAeMe_.js" as="script"><link rel="prefetch" href="/assets/golang-容易被-k8s-误导的-json-inline.html-DVDmi_BF.js" as="script"><link rel="prefetch" href="/assets/python异步初探-协程的定义.html-7BiD-MCz.js" as="script"><link rel="prefetch" href="/assets/python-auto-doc-for-drf.html-D5_bR_8e.js" as="script"><link rel="prefetch" href="/assets/pydantic-with-drf-yasg.html-Dc_lAfD6.js" as="script"><link rel="prefetch" href="/assets/python异步进阶-探讨协程实现异步的细节.html-P56mA8qN.js" as="script"><link rel="prefetch" href="/assets/fastapi与依赖注入模式.html-Cb2VureC.js" as="script"><link rel="prefetch" href="/assets/bkpaas-refactor-experience.html-b8CxnvHV.js" as="script"><link rel="prefetch" href="/assets/记一次-nginx-ingress-长连接异常断开问题复盘过程.html-D-qKJTH6.js" as="script"><link rel="prefetch" href="/assets/let-s-encrypt-实现全自动免费-https-证书托管-自动签发、续期.html-BWkZbh-B.js" as="script"><link rel="prefetch" href="/assets/index.html-fUCq_CaK.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-oci-运行时规范.html-DKuf6p1f.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-从-0-开始带你徒手构建-docker-镜像.html-B-9SDbqD.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-浅谈从镜像创建容器的实现细节.html-BNKwUaGz.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-手把手教你如何推镜像至-docker-registry.html-DCt48dCV.js" as="script"><link rel="prefetch" href="/assets/wasm-or-container.html-BcZtMjqw.js" as="script"><link rel="prefetch" href="/assets/404.html-B7mvWyc2.js" as="script"><link rel="prefetch" href="/assets/index.html-DDFO4wUt.js" as="script"><link rel="prefetch" href="/assets/index.html-DNbbggur.js" as="script"><link rel="prefetch" href="/assets/index.html-B0AKgYAp.js" as="script"><link rel="prefetch" href="/assets/index.html-B02RA5O6.js" as="script"><link rel="prefetch" href="/assets/index.html-030TOHWE.js" as="script"><link rel="prefetch" href="/assets/index.html-DyX1vlvx.js" as="script"><link rel="prefetch" href="/assets/index.html-DaQpX6xW.js" as="script"><link rel="prefetch" href="/assets/index.html-CF-2cgkS.js" as="script"><link rel="prefetch" href="/assets/index.html-bZ1iRUM0.js" as="script"><link rel="prefetch" href="/assets/index.html-DzoYoIX0.js" as="script"><link rel="prefetch" href="/assets/index.html-CTDnYwJI.js" as="script"><link rel="prefetch" href="/assets/index.html-CMN1p8gg.js" as="script"><link rel="prefetch" href="/assets/index.html-SuIVStis.js" as="script"><link rel="prefetch" href="/assets/index.html-BL0JCv_d.js" as="script"><link rel="prefetch" href="/assets/index.html-cCGulRAM.js" as="script"><link rel="prefetch" href="/assets/index.html-ve4cmh0I.js" as="script"><link rel="prefetch" href="/assets/index.html-DCY7JPtF.js" as="script"><link rel="prefetch" href="/assets/index.html-BYSJr56O.js" as="script"><link rel="prefetch" href="/assets/index.html-C2dvDLv9.js" as="script"><link rel="prefetch" href="/assets/index.html-DP0kKMRd.js" as="script"><link rel="prefetch" href="/assets/index.html-CP5XIUgE.js" as="script"><link rel="prefetch" href="/assets/index.html-CF-f9AGX.js" as="script"><link rel="prefetch" href="/assets/index.html-DrrqMUt5.js" as="script"><link rel="prefetch" href="/assets/index.html-u4_s61TQ.js" as="script"><link rel="prefetch" href="/assets/index.html-C-o2beRV.js" as="script"><link rel="prefetch" href="/assets/index.html-Dv6k--_O.js" as="script"><link rel="prefetch" href="/assets/index.html-b3CgNTW2.js" as="script"><link rel="prefetch" href="/assets/index.html-CGfYwuXf.js" as="script"><link rel="prefetch" href="/assets/index.html-DHcHmIAn.js" as="script"><link rel="prefetch" href="/assets/index.html-CKoyYuQW.js" as="script"><link rel="prefetch" href="/assets/index.html-C2RMEevR.js" as="script"><link rel="prefetch" href="/assets/index.html-D358tJEd.js" as="script"><link rel="prefetch" href="/assets/index.html-DXfWGbA2.js" as="script"><link rel="prefetch" href="/assets/index.html-CgDOFA_z.js" as="script"><link rel="prefetch" href="/assets/index.html-CI6A7feQ.js" as="script"><link rel="prefetch" href="/assets/index.html-dx836Acv.js" as="script"><link rel="prefetch" href="/assets/index.html-D5_jDjWH.js" as="script"><link rel="prefetch" href="/assets/index.html-Cn2GgVHf.js" as="script"><link rel="prefetch" href="/assets/index.html-XCfIz_vS.js" as="script"><link rel="prefetch" href="/assets/index.html-DF0S3nZ1.js" as="script"><link rel="prefetch" href="/assets/index.html-CW0P11HW.js" as="script"><link rel="prefetch" href="/assets/index.html-BzrF1WSv.js" as="script"><link rel="prefetch" href="/assets/index.html-FsWAkJsu.js" as="script"><link rel="prefetch" href="/assets/index.html-DEtvcX3V.js" as="script"><link rel="prefetch" href="/assets/index.html-BkCvLD_W.js" as="script"><link rel="prefetch" href="/assets/index.html-DhlA2JRc.js" as="script"><link rel="prefetch" href="/assets/giscus-7BMGhbDA.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="header" class="vp-header" style="background-image:url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNjQiIGhlaWdodD0iMjY0Ij48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJyZ2IoODAsNjksMTM4KSI+PC9yZWN0PjxjaXJjbGUgY3g9IjIyLjAwMDAwMDAwMDAwMDAwNCIgY3k9IjIyLjAwMDAwMDAwMDAwMDAwNCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjIuMDAwMDAwMDAwMDAwMDA0IiBjeT0iMjIuMDAwMDAwMDAwMDAwMDA0IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjA1NDY2NjY2NjY2NjY2NjY3Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSI2Ni4wMDAwMDAwMDAwMDAwMSIgY3k9IjIyLjAwMDAwMDAwMDAwMDAwNCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMTI0MDAwMDAwMDAwMDAwMDEiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iNjYuMDAwMDAwMDAwMDAwMDEiIGN5PSIyMi4wMDAwMDAwMDAwMDAwMDQiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjMjIyIiBmaWxsLW9wYWNpdHk9IjAuMTMyNjY2NjY2NjY2NjY2NjUiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjExMC4wMDAwMDAwMDAwMDAwMSIgY3k9IjIyLjAwMDAwMDAwMDAwMDAwNCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTEwLjAwMDAwMDAwMDAwMDAxIiBjeT0iMjIuMDAwMDAwMDAwMDAwMDA0IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iIzIyMiIgZmlsbC1vcGFjaXR5PSIwLjA0NiI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTU0IiBjeT0iMjIuMDAwMDAwMDAwMDAwMDA0IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxNTQiIGN5PSIyMi4wMDAwMDAwMDAwMDAwMDQiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE5OC4wMDAwMDAwMDAwMDAwMyIgY3k9IjIyLjAwMDAwMDAwMDAwMDAwNCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMDk4IiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE5OC4wMDAwMDAwMDAwMDAwMyIgY3k9IjIyLjAwMDAwMDAwMDAwMDAwNCIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4wODA2NjY2NjY2NjY2NjY2NiI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjQyLjAwMDAwMDAwMDAwMDA2IiBjeT0iMjIuMDAwMDAwMDAwMDAwMDA0IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzIyMiIgb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSIyMi4wMDAwMDAwMDAwMDAwMDQiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjIyLjAwMDAwMDAwMDAwMDAwNCIgY3k9IjY2LjAwMDAwMDAwMDAwMDAxIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4wODkzMzMzMzMzMzMzMzMzMyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyMi4wMDAwMDAwMDAwMDAwMDQiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4wNjMzMzMzMzMzMzMzMzMzNCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iNjYuMDAwMDAwMDAwMDAwMDEiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iNjYuMDAwMDAwMDAwMDAwMDEiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4xNDEzMzMzMzMzMzMzMzMzNCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTEwLjAwMDAwMDAwMDAwMDAxIiBjeT0iNjYuMDAwMDAwMDAwMDAwMDEiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjEyNDAwMDAwMDAwMDAwMDAxIiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjExMC4wMDAwMDAwMDAwMDAwMSIgY3k9IjY2LjAwMDAwMDAwMDAwMDAxIiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjEwNjY2NjY2NjY2NjY2NjY3Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxNTQiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMTE1MzMzMzMzMzMzMzMzMzQiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTU0IiBjeT0iNjYuMDAwMDAwMDAwMDAwMDEiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDcyMDAwMDAwMDAwMDAwMDEiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE5OC4wMDAwMDAwMDAwMDAwMyIgY3k9IjY2LjAwMDAwMDAwMDAwMDAxIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzIyMiIgb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjQyLjAwMDAwMDAwMDAwMDA2IiBjeT0iNjYuMDAwMDAwMDAwMDAwMDEiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjIyIiBvcGFjaXR5PSIwLjA0NiIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSI2Ni4wMDAwMDAwMDAwMDAwMSIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4wMjg2NjY2NjY2NjY2NjY2NjciPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjIyLjAwMDAwMDAwMDAwMDAwNCIgY3k9IjExMC4wMDAwMDAwMDAwMDAwMSIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMTMyNjY2NjY2NjY2NjY2NjUiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjIuMDAwMDAwMDAwMDAwMDA0IiBjeT0iMTEwLjAwMDAwMDAwMDAwMDAxIiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjAyIj48L2NpcmNsZT48Y2lyY2xlIGN4PSI2Ni4wMDAwMDAwMDAwMDAwMSIgY3k9IjExMC4wMDAwMDAwMDAwMDAwMSIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iNjYuMDAwMDAwMDAwMDAwMDEiIGN5PSIxMTAuMDAwMDAwMDAwMDAwMDEiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjExMC4wMDAwMDAwMDAwMDAwMSIgY3k9IjExMC4wMDAwMDAwMDAwMDAwMSIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTEwLjAwMDAwMDAwMDAwMDAxIiBjeT0iMTEwLjAwMDAwMDAwMDAwMDAxIiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iIzIyMiIgZmlsbC1vcGFjaXR5PSIwLjA2MzMzMzMzMzMzMzMzMzM0Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxNTQiIGN5PSIxMTAuMDAwMDAwMDAwMDAwMDEiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjE0MTMzMzMzMzMzMzMzMzM0IiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE1NCIgY3k9IjExMC4wMDAwMDAwMDAwMDAwMSIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4xNDEzMzMzMzMzMzMzMzMzNCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTk4LjAwMDAwMDAwMDAwMDAzIiBjeT0iMTEwLjAwMDAwMDAwMDAwMDAxIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSIxMTAuMDAwMDAwMDAwMDAwMDEiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjMjIyIiBmaWxsLW9wYWNpdHk9IjAuMDI4NjY2NjY2NjY2NjY2NjY3Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSIxMTAuMDAwMDAwMDAwMDAwMDEiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjIyIiBvcGFjaXR5PSIwLjA5OCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSIxMTAuMDAwMDAwMDAwMDAwMDEiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDIiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjIyLjAwMDAwMDAwMDAwMDAwNCIgY3k9IjE1NCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDIiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjIuMDAwMDAwMDAwMDAwMDA0IiBjeT0iMTU0IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iIzIyMiIgZmlsbC1vcGFjaXR5PSIwLjEzMjY2NjY2NjY2NjY2NjY1Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSI2Ni4wMDAwMDAwMDAwMDAwMSIgY3k9IjE1NCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMDI4NjY2NjY2NjY2NjY2NjY3IiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjY2LjAwMDAwMDAwMDAwMDAxIiBjeT0iMTU0IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjAyIj48L2NpcmNsZT48Y2lyY2xlIGN4PSIxMTAuMDAwMDAwMDAwMDAwMDEiIGN5PSIxNTQiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjAyIiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjExMC4wMDAwMDAwMDAwMDAwMSIgY3k9IjE1NCIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4wMjg2NjY2NjY2NjY2NjY2NjciPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE1NCIgY3k9IjE1NCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMTMyNjY2NjY2NjY2NjY2NjUiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTU0IiBjeT0iMTU0IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjAyIj48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSIxNTQiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjAyIiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE5OC4wMDAwMDAwMDAwMDAwMyIgY3k9IjE1NCIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4wOTgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgY3k9IjE1NCIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMDI4NjY2NjY2NjY2NjY2NjY3IiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgY3k9IjE1NCIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjIuMDAwMDAwMDAwMDAwMDA0IiBjeT0iMTk4LjAwMDAwMDAwMDAwMDAzIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4xNDEzMzMzMzMzMzMzMzMzNCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyMi4wMDAwMDAwMDAwMDAwMDQiIGN5PSIxOTguMDAwMDAwMDAwMDAwMDMiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMTQxMzMzMzMzMzMzMzMzMzQiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjY2LjAwMDAwMDAwMDAwMDAxIiBjeT0iMTk4LjAwMDAwMDAwMDAwMDAzIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzIyMiIgb3BhY2l0eT0iMC4wNjMzMzMzMzMzMzMzMzMzNCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSI2Ni4wMDAwMDAwMDAwMDAwMSIgY3k9IjE5OC4wMDAwMDAwMDAwMDAwMyIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4wNTQ2NjY2NjY2NjY2NjY2NyI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTEwLjAwMDAwMDAwMDAwMDAxIiBjeT0iMTk4LjAwMDAwMDAwMDAwMDAzIiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4wODkzMzMzMzMzMzMzMzMzMyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxMTAuMDAwMDAwMDAwMDAwMDEiIGN5PSIxOTguMDAwMDAwMDAwMDAwMDMiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE1NCIgY3k9IjE5OC4wMDAwMDAwMDAwMDAwMyIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiNkZGQiIG9wYWNpdHk9IjAuMDIiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTU0IiBjeT0iMTk4LjAwMDAwMDAwMDAwMDAzIiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iIzIyMiIgZmlsbC1vcGFjaXR5PSIwLjEzMjY2NjY2NjY2NjY2NjY1Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSIxOTguMDAwMDAwMDAwMDAwMDMiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjIyIiBvcGFjaXR5PSIwLjAyODY2NjY2NjY2NjY2NjY2NyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSIxOTguMDAwMDAwMDAwMDAwMDMiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjMjIyIiBmaWxsLW9wYWNpdHk9IjAuMDQ2Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSIxOTguMDAwMDAwMDAwMDAwMDMiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjEwNjY2NjY2NjY2NjY2NjY3IiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgY3k9IjE5OC4wMDAwMDAwMDAwMDAwMyIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjIuMDAwMDAwMDAwMDAwMDA0IiBjeT0iMjQyLjAwMDAwMDAwMDAwMDA2IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyMi4wMDAwMDAwMDAwMDAwMDQiIGN5PSIyNDIuMDAwMDAwMDAwMDAwMDYiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjMjIyIiBmaWxsLW9wYWNpdHk9IjAuMTE1MzMzMzMzMzMzMzMzMzQiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjY2LjAwMDAwMDAwMDAwMDAxIiBjeT0iMjQyLjAwMDAwMDAwMDAwMDA2IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSI2Ni4wMDAwMDAwMDAwMDAwMSIgY3k9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiNkZGQiIGZpbGwtb3BhY2l0eT0iMC4xMjQwMDAwMDAwMDAwMDAwMSI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTEwLjAwMDAwMDAwMDAwMDAxIiBjeT0iMjQyLjAwMDAwMDAwMDAwMDA2IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2RkZCIgb3BhY2l0eT0iMC4xNDEzMzMzMzMzMzMzMzMzNCIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIxMTAuMDAwMDAwMDAwMDAwMDEiIGN5PSIyNDIuMDAwMDAwMDAwMDAwMDYiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjZGRkIiBmaWxsLW9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE1NCIgY3k9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgcj0iMTguMzMzMzMzMzMzMzMzMzM2IiBmaWxsPSJub25lIiBzdHJva2U9IiMyMjIiIG9wYWNpdHk9IjAuMDYzMzMzMzMzMzMzMzMzMzQiIHN0cm9rZS13aWR0aD0iNy4zMzMzMzMzMzMzMzMzMzRweCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMTU0IiBjeT0iMjQyLjAwMDAwMDAwMDAwMDA2IiByPSI5LjE2NjY2NjY2NjY2NjY2OCIgZmlsbD0iI2RkZCIgZmlsbC1vcGFjaXR5PSIwLjA4OTMzMzMzMzMzMzMzMzMzIj48L2NpcmNsZT48Y2lyY2xlIGN4PSIxOTguMDAwMDAwMDAwMDAwMDMiIGN5PSIyNDIuMDAwMDAwMDAwMDAwMDYiIHI9IjE4LjMzMzMzMzMzMzMzMzMzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZGRkIiBvcGFjaXR5PSIwLjA4OTMzMzMzMzMzMzMzMzMzIiBzdHJva2Utd2lkdGg9IjcuMzMzMzMzMzMzMzMzMzM0cHgiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjE5OC4wMDAwMDAwMDAwMDAwMyIgY3k9IjI0Mi4wMDAwMDAwMDAwMDAwNiIgcj0iOS4xNjY2NjY2NjY2NjY2NjgiIGZpbGw9IiMyMjIiIGZpbGwtb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCI+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjQyLjAwMDAwMDAwMDAwMDA2IiBjeT0iMjQyLjAwMDAwMDAwMDAwMDA2IiByPSIxOC4zMzMzMzMzMzMzMzMzMzYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzIyMiIgb3BhY2l0eT0iMC4wODA2NjY2NjY2NjY2NjY2NiIgc3Ryb2tlLXdpZHRoPSI3LjMzMzMzMzMzMzMzMzMzNHB4Ij48L2NpcmNsZT48Y2lyY2xlIGN4PSIyNDIuMDAwMDAwMDAwMDAwMDYiIGN5PSIyNDIuMDAwMDAwMDAwMDAwMDYiIHI9IjkuMTY2NjY2NjY2NjY2NjY4IiBmaWxsPSIjMjIyIiBmaWxsLW9wYWNpdHk9IjAuMDk4Ij48L2NpcmNsZT48L3N2Zz4=&quot;);"><div class="vp-navbar-container"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/en/"><img class="vp-nav-logo" src="/img/avatar.png" alt><!----><span class="vp-site-name hide-in-pad">Personal technical article sharing</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/" aria-label="Home"><span class="font-icon icon home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/article/" aria-label="Articles"><span class="font-icon icon book" style=""></span>Articles<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/resume/" aria-label="About Me"><span class="font-icon icon circle-question" style=""></span>About Me<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="dropdown-item"><a class="route-link nav-link active" href="/en/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/shabbywu/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></div><div class="banner"><h1 class="text">How To Build Images:Docker Image Specification v1.2</h1></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><div><!--[--><div class="blog-page"><main id="main-content" class="blog-main"><div class="blog-post custom"><section class="post-meta main-div"><div class="post-date"><span>Writing Date：</span> <span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-01-31T00:00:00.000Z"></span></div><!--v-if--><div class="post-links"><a href="/en/posts/2021/03/31/how-to-run-container-oci-%E8%BF%90%E8%A1%8C%E6%97%B6%E8%A7%84%E8%8C%83.html" class=""><span>：</span><span>How To Run Container:OCI Runtime Specification</span></a></div></section><article class="blog-post-content main-div"><div class="vp-page-title"><h1><!---->How To Build Images:Docker Image Specification v1.2</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/shabbywu" target="_blank" rel="noopener noreferrer">shabbywu</a></span><span property="author" content="shabbywu"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-01-31T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 11 min</span><meta property="timeRequired" content="PT11M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category0 clickable" role="navigation">Container Technology</span><!--]--><meta property="articleSection" content="Container Technology"></span><!----></div><hr></div><div class="theme-hope-content" id="markdown-content"><h2 id="preface" tabindex="-1"><a class="header-anchor" href="#preface"><span>Preface</span></a></h2><p>We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is also straightforward; most of the time, launching a container simply involves executing <code>docker run {your-image-name}</code>, and building an image is as simple as executing <code>docker build dockerfile .</code>.<br> Perhaps it&#39;s precisely because Docker encapsulates implementation details so thoroughly that I recently realized, while learning about kaniko, an open-source image building tool by Google, that we may have only learned <strong>how to use Docker CLI</strong>, rather than understanding how Docker actually operates.<br> Therefore, I has decided to start writing a series of articles about <strong>『How To Build Images』</strong>, with this being the first installment: 『Docker Image Specification』.</p><blockquote><p>Note: This article assumes that readers know how to use Docker, including but not limited to knowing how to execute <code>docker run</code> and <code>docker build</code> and writing a Dockerfile.</p></blockquote><h2 id="docker-image-specification" tabindex="-1"><a class="header-anchor" href="#docker-image-specification"><span><a href="https://github.com/moby/moby/tree/master/image/spec" target="_blank" rel="noopener noreferrer">Docker Image Specification<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></span></a></h2><p>Container images store changes to the file system, while container image specification describes <strong>how to record the history of these changes and the corresponding operation parameters</strong> as well as <strong>how to convert container images into containers</strong>.</p><blockquote><p>Simply, it describes the specifications for <strong>container &gt;&gt; serialization &gt;&gt; image</strong> and <strong>image &gt;&gt; deserialization &gt;&gt; container</strong> 😯</p></blockquote><h3 id="specification-history" tabindex="-1"><a class="header-anchor" href="#specification-history"><span>Specification History</span></a></h3><ul><li><a href="https://github.com/moby/moby/blob/master/image/spec/v1.md" target="_blank" rel="noopener noreferrer">v1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>first edition</li></ul></li><li><a href="https://github.com/moby/moby/blob/master/image/spec/v1.1.md" target="_blank" rel="noopener noreferrer">v1.1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>Implemented by Docker v1.10 (February, 2016)</li><li>use sha256 digests as ids for each layer from now on(previously used random values)</li><li>Added <strong>manifest.json</strong> file, which is responsible for recording metadata of image content and dependencies.</li></ul></li><li><a href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md" target="_blank" rel="noopener noreferrer">v1.2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>mplemented by Docker v1.12 (July, 2016)</li><li>add Healthcheck into image specifications</li></ul></li><li><a href="(https://github.com/opencontainers/image-spec)">OCI v1 image</a><ul><li>Image specification proposed by the Open Container Initiative (OCI)</li><li>Not compatible with <a href="https://github.com/moby/moby/pull/33355" target="_blank" rel="noopener noreferrer">Docker(moby)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, But you can push image to the Registry and then pull it back and registry will auto convert it into the one docker(moby) is supported.</li></ul></li></ul><p>To standardize container formats and runtime creation, Docker, along with organizations like CoreOS, established the Open Container Initiative (OCI) under the supervision of the Linux Foundation. Currently, OCI has proposed two specifications: the <a href="https://github.com/opencontainers/runtime-spec" target="_blank" rel="noopener noreferrer">Runtime Specification (runtime-spec)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and the <a href="https://github.com/opencontainers/image-spec" target="_blank" rel="noopener noreferrer">Image Specification (image-spec)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.<br> However, <strong>since Docker has not yet fully adopted the OCI image specification, this series of articles will not cover content related to the OCI image specification</strong>. <s>(MAY be considered in the future 😆)</s></p><h3 id="a-🌰-basic-structure-of-docker-images" tabindex="-1"><a class="header-anchor" href="#a-🌰-basic-structure-of-docker-images"><span>A 🌰: Basic Structure of Docker Images</span></a></h3><p>We will use <em>busybox:latest</em> as an example to show the basic structure of a Docker image.</p><details class="hint-container details"><summary>What is 🌰 meaning?</summary><p>🌰 is the homophone of example in chinese.</p></details><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.
├── 036a82c6d65f2fa43a13599661490be3fca1c3d6790814668d4e8c0213153b12
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 6ad733544a6317992a6fac4eb19fe1df577d4dec7529efec28a5bd0edad0fd30.json
├── manifest.json
└── repositories

1 directory, 6 files
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, this 🌰 will introduce in detail the meaning and content of each component in the Docker image.</p><h4 id="files-in-directories-backward-compatibility-only" tabindex="-1"><a class="header-anchor" href="#files-in-directories-backward-compatibility-only"><span>files in directories (backward compatibility only)</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.
├── VERSION
├── json
└── layer.tar

0 directories, 3 files
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It can be observed that each layer in the image can be mapped to a directory after decompression. The names of these directories are generated using a consistent hash algorithm based on the relevant information of the layer (TIPS: randomly generated in v1 specification). Each directory contains three files:</p><ul><li>VERSION, the spec version of <code>json</code> file, which is currently set to 1.0.</li><li>json, which contain metadata defining information about the layer in v1 specification, but it is not required in v1.2 specification, so we can ignore this file.</li><li>layer.tar, an archive file storing the changes made to the file system of the layer.</li></ul><blockquote><p>It&#39;s worth noting that this directory layout is only for backward compatibility. In the current version (v1.2), the archive files for each layer are specified in <code>manifest.json</code>.</p></blockquote><h4 id="repositories-backward-compatibility-only" tabindex="-1"><a class="header-anchor" href="#repositories-backward-compatibility-only"><span>repositories (backward compatibility only)</span></a></h4><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
  &quot;busybox&quot;: {
    &quot;latest&quot;: &quot;036a82c6d65f2fa43a13599661490be3fca1c3d6790814668d4e8c0213153b12&quot;
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>repositories</code> file contains a JSON object where each key represents the name of an image, and its corresponding value is <strong>a mapping of tags to image IDs</strong>.</p><blockquote><p>It&#39;s important to note that this file is also used for backward compatibility. In the current version (v1.2), the relationship between images and layers is specified in <code>manifest.json</code>.</p></blockquote><h4 id="manifest-json" tabindex="-1"><a class="header-anchor" href="#manifest-json"><span>manifest.json</span></a></h4><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>[
  {
    &quot;Config&quot;: &quot;6ad733544a6317992a6fac4eb19fe1df577d4dec7529efec28a5bd0edad0fd30.json&quot;,
    &quot;RepoTags&quot;: [
      &quot;busybox:latest&quot;
    ],
    &quot;Layers&quot;: [
      &quot;036a82c6d65f2fa43a13599661490be3fca1c3d6790814668d4e8c0213153b12/layer.tar&quot;
    ]
  }
]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>manifest.json</code> records a list where each item describes the contents inventory of an image and its parent image (optional). Each item in this list consists of the following fields:</p><ul><li>Config: Reference to the configuration object that starts the container.</li><li>RepoTags: Describes the reference relationships of the image.</li><li>Layers: Points to the records of changes made to the file system of the image&#39;s layers.</li><li>Parent: (optional) The image ID of the parent image. This parent image must be listed in the current <code>manifest.json</code>.</li></ul><blockquote><p>It&#39;s important to note that this <code>manifest.json</code> is not the same file as the <code>manifest.json</code> described in the Docker Registry API (see the appendix for details).</p></blockquote><h4 id="config-aka-image-json" tabindex="-1"><a class="header-anchor" href="#config-aka-image-json"><span>Config (aka Image JSON)</span></a></h4><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
	&quot;architecture&quot;: &quot;amd64&quot;,
	&quot;config&quot;: {
		&quot;Hostname&quot;: &quot;&quot;,
		&quot;Domainname&quot;: &quot;&quot;,
		&quot;User&quot;: &quot;&quot;,
		&quot;AttachStdin&quot;: false,
		&quot;AttachStdout&quot;: false,
		&quot;AttachStderr&quot;: false,
		&quot;Tty&quot;: false,
		&quot;OpenStdin&quot;: false,
		&quot;StdinOnce&quot;: false,
		&quot;Env&quot;: [
			&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
		],
		&quot;Cmd&quot;: [
			&quot;sh&quot;
		],
		&quot;ArgsEscaped&quot;: true,
		&quot;Image&quot;: &quot;sha256:7def3adf6786f772d2f02fc74c2d3f3334228416760aee45d3b6e561ce1c1dd3&quot;,
		&quot;Volumes&quot;: null,
		&quot;WorkingDir&quot;: &quot;&quot;,
		&quot;Entrypoint&quot;: null,
		&quot;OnBuild&quot;: null,
		&quot;Labels&quot;: null
	},
	&quot;container&quot;: &quot;3fbce8bb8947b036ee7ff05a86c0574159c04fc10a3db7485ab7bf4f56fd4020&quot;,
	&quot;container_config&quot;: {
		&quot;Hostname&quot;: &quot;3fbce8bb8947&quot;,
		&quot;Domainname&quot;: &quot;&quot;,
		&quot;User&quot;: &quot;&quot;,
		&quot;AttachStdin&quot;: false,
		&quot;AttachStdout&quot;: false,
		&quot;AttachStderr&quot;: false,
		&quot;Tty&quot;: false,
		&quot;OpenStdin&quot;: false,
		&quot;StdinOnce&quot;: false,
		&quot;Env&quot;: [
			&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
		],
		&quot;Cmd&quot;: [
			&quot;/bin/sh&quot;,
			&quot;-c&quot;,
			&quot;#(nop) &quot;,
			&quot;CMD [\&quot;sh\&quot;]&quot;
		],
		&quot;ArgsEscaped&quot;: true,
		&quot;Image&quot;: &quot;sha256:7def3adf6786f772d2f02fc74c2d3f3334228416760aee45d3b6e561ce1c1dd3&quot;,
		&quot;Volumes&quot;: null,
		&quot;WorkingDir&quot;: &quot;&quot;,
		&quot;Entrypoint&quot;: null,
		&quot;OnBuild&quot;: null,
		&quot;Labels&quot;: {}
	},
	&quot;created&quot;: &quot;2017-11-03T22:39:17.345892474Z&quot;,
	&quot;docker_version&quot;: &quot;17.06.2-ce&quot;,
	&quot;history&quot;: [{
			&quot;created&quot;: &quot;2017-11-03T22:39:17.173629428Z&quot;,
			&quot;created_by&quot;: &quot;/bin/sh -c #(nop) ADD file:264af0c48e23e8b8fc57c2c70c7b5b08be20601d75f5efca07c5ace8748bcbcd in / &quot;
		},
		{
			&quot;created&quot;: &quot;2017-11-03T22:39:17.345892474Z&quot;,
			&quot;created_by&quot;: &quot;/bin/sh -c #(nop)  CMD [\&quot;sh\&quot;]&quot;,
			&quot;empty_layer&quot;: true
		}
	],
	&quot;os&quot;: &quot;linux&quot;,
	&quot;rootfs&quot;: {
		&quot;type&quot;: &quot;layers&quot;,
		&quot;diff_ids&quot;: [
			&quot;sha256:0271b8eebde3fa9a6126b1f2335e170f902731ab4942f9f1914e77016540c7bb&quot;
		]
	}
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="created-string" tabindex="-1"><a class="header-anchor" href="#created-string"><span>created <code>string</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;created&quot;: &quot;2017-11-03T22:39:17.345892474Z&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>created</code> is a string in ISO-8601 format, describing the date and time the current image was created.</p><h5 id="author-string" tabindex="-1"><a class="header-anchor" href="#author-string"><span>author <code>string</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;author&quot;: &quot;nobody&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>author</code> describes the name and/or email address of the person or entity that created and maintains this image.</p><h5 id="architecture-string" tabindex="-1"><a class="header-anchor" href="#architecture-string"><span>architecture <code>string</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;architecture&quot;: &quot;amd64&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>architecture</code> describes the CPU architecture that the binary files in this image depend on to run. Possible values include:</p><ul><li>386</li><li>amd64</li><li>arm</li></ul><blockquote><p>It should be noted that the values in the optional range may be added or reduced in the future, and at the same time, the values declared here may not be supported by the container runtime implementation (e.g. runc or rkt).</p></blockquote><h5 id="os-string" tabindex="-1"><a class="header-anchor" href="#os-string"><span>os <code>string</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;os&quot;: &quot;linux&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>os</code> describes the name of the operating system this image is running on. Possible values include:</p><ul><li>darwin</li><li>freebsd</li><li>linux</li></ul><blockquote><p>It should be noted that the values in the optional range may be added or reduced in the future, and at the same time, the values declared here may not be supported by the container runtime implementation (e.g. runc or rkt).</p></blockquote><h5 id="config-aka-container-runconfig-object-optional" tabindex="-1"><a class="header-anchor" href="#config-aka-container-runconfig-object-optional"><span>config (aka Container RunConfig) <code>object, optional</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;User&quot;: &quot;&quot;,
        &quot;Tty&quot;: false,
        &quot;Env&quot;: [
            &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
        ],
        &quot;Entrypoint&quot;: null,
        &quot;Cmd&quot;: [
            &quot;sh&quot;
        ],
        &quot;Volumes&quot;: null,
        &quot;WorkingDir&quot;: &quot;&quot;,
        &quot;Labels&quot;: null
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>config describes the default parameters used by the container runtime when instantiating the image.</p><blockquote><p>It should be noted that this field can be null, in which case any parameters required to run should be specified when creating the container.</p></blockquote><h6 id="user-string" tabindex="-1"><a class="header-anchor" href="#user-string"><span>User <code>string</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;User&quot;: &quot;root&quot;
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>User</code> describes the username or UID that should be used in the container. This value will be used as the default when the value is not specified when the container is created. This field supports the following formats:</p><ul><li>user</li><li>uid</li><li>user:group</li><li>uid:gid</li><li>uid:group</li><li>user:gid</li></ul><blockquote><p>Note that when no <code>group/gid</code> is provided, the default behavior is to configure the default combination of supplementary groups from <code>/etc/passwd</code> in the container based on the given user/uid.</p></blockquote><h6 id="memory-integer" tabindex="-1"><a class="header-anchor" href="#memory-integer"><span>Memory <code>integer</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Memory&quot;: 1024
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Memory</code> describes the memory limit of the container instance (in bytes), which will be used as the default when this value is not specified when creating the container.</p><h6 id="memoryswap-integer" tabindex="-1"><a class="header-anchor" href="#memoryswap-integer"><span>MemorySwap <code>integer</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;MemorySwap&quot;: -1
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>MemorySwap</code> describes the total memory usage (memory + swap) that the container is allowed to use. This value is used as the default value when this value is not specified when creating the container.</p><blockquote><p>It should be noted that setting this value to -1 means turning off memory swapping.</p></blockquote><h6 id="cpushares-integer" tabindex="-1"><a class="header-anchor" href="#cpushares-integer"><span>CpuShares <code>integer</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;CpuShares&quot;: 4
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>CpuShares</code> describes the cpu shares relative to other containers, used as the default when this value is not specified when creating the container.</p><h6 id="workingdir-string" tabindex="-1"><a class="header-anchor" href="#workingdir-string"><span>WorkingDir <code>string</code></span></a></h6><p><code>WorkingDir</code> describes the working directory where the container starts the entry point process. When this value is not specified when creating the container, this value will be used as the default value.</p><h6 id="env-array-string" tabindex="-1"><a class="header-anchor" href="#env-array-string"><span>Env <code>array[string]</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Env&quot;: [
            &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
        ]
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Env</code> describes the default environment variables when running this image. These values will be used as default values and will be combined with the values specified when creating the container. The format of each item in this list is: <code>VARNAME=&quot;VAR VALUE&quot;</code></p><h6 id="entrypoint-array-string" tabindex="-1"><a class="header-anchor" href="#entrypoint-array-string"><span>Entrypoint <code>array[string]</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Entrypoint&quot;: [
            &quot;bash&quot;,
            &quot;-c&quot;
        ]
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Entrypoint</code> A list of parameters describing the command to be executed when starting the container, this value will be used as the default when this value is not specified when the container is created.</p><h6 id="cmd-array-string" tabindex="-1"><a class="header-anchor" href="#cmd-array-string"><span>Cmd <code>array[string]</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Cmd&quot;: [
            &quot;ls&quot;,
        ]
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Cmd</code> describes the default parameters of the container entrypoint. When this value is not specified when creating the container, this value will be used as the default value.</p><blockquote><p>It should be noted that if <code>Entrypoint</code> is not specified, the first item in the cmd array should be the executable file to be run.</p></blockquote><h6 id="healthcheck-object" tabindex="-1"><a class="header-anchor" href="#healthcheck-object"><span>Healthcheck <code>object</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Healthcheck&quot;: {
            &quot;Test&quot;: [
                &quot;CMD-SHELL&quot;,
                &quot;/usr/bin/check-health localhost&quot;
            ],
            &quot;Interval&quot;: 30000000000,
            &quot;Timeout&quot;: 10000000000,
            &quot;Retries&quot;: 3
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Healthcheck describes the method to confirm whether the container is healthy. This object consists of 4 parts, namely:</p><ul><li>Test <code>array[string]</code>, a test method to check whether the container is healthy, the options are: <ul><li><code>[]</code>: Inherit health check configuration from parent image</li><li><code>[&quot;None&quot;]</code>: disable health checks</li><li><code>[&quot;CMD&quot;, arg1, arg2, ...]</code>: execute parameters directly</li><li><code>[&quot;CMD-SHELL&quot;, command]</code>: Use the default shell in the image to run the command</li></ul></li><li>Interval <code>integer</code>: Number of nanoseconds to wait between probes.</li><li>Timeout <code>integer</code>: The number of nanoseconds to wait in a probe.</li><li>Retries <code>integer</code>: The number of consecutive failures required to consider the container unhealthy. If this field is omitted, it means that the value should be obtained from the parent image, and these values will be used as default values, combined with the values specified when the container was created.</li></ul><h6 id="exposedports-object-optional" tabindex="-1"><a class="header-anchor" href="#exposedports-object-optional"><span>ExposedPorts <code>object, optional</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;ExposedPorts&quot;: {
            &quot;8080&quot;: {},
            &quot;53/udp&quot;: {},
            &quot;80/tcp&quot;: {}
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ExposedPorts describes the port group that needs to be exposed to the outside world by the container running the image. The storage structure is a json object, each key of the object is the port and protocol that need to be exposed, and the value must be an empty object <code>{}</code>. The key of this object can be in the following formats:</p><ul><li>port/tcp</li><li>port/udp</li><li>port</li></ul><blockquote><p>It should be noted that the reason why the structure of this configuration is so weird is that it is directly serialized from the Go type map[string]struct{}, so the value in json is an empty object <code>{}</code> .</p></blockquote><h6 id="volumes-object-optional" tabindex="-1"><a class="header-anchor" href="#volumes-object-optional"><span>Volumes <code>object, optional</code></span></a></h6><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;config&quot;: {
        &quot;Volumes&quot;: {
            &quot;/var/my-app-data/&quot;: {},
            &quot;/etc/some-config.d/&quot;: {}
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Volumes describes the directory path that the container running the image should be covered by the mounted volume. The storage structure is a json object. Each key of the object is a directory path that should be covered by the mounted volume. The value must be an empty object <code>{}</code>.</p><blockquote><p>It should be noted that the reason why the structure of this configuration is so weird is that it is directly serialized from the Go type map[string]struct{}, so the value in json is an empty object <code>{}</code> .</p></blockquote><h5 id="rootfs-object" tabindex="-1"><a class="header-anchor" href="#rootfs-object"><span>rootfs <code>object</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;rootfs&quot;: {
        &quot;type&quot;: &quot;layers&quot;,
        &quot;diff_ids&quot;: [
            &quot;sha256:0271b8eebde3fa9a6126b1f2335e170f902731ab4942f9f1914e77016540c7bb&quot;
        ]
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>rootfs</code> describes the Layer DiffIDs referenced by the image (see Appendix - Glossary for details). Storing this value in the image configuration (Config) allows the hash value of the image configuration file to be calculated based on the hash value of the associated file system. Change with change. This object contains two parts, namely:</p><ul><li>type: Normally set this value to <code>layers</code>.</li><li>diff_ids <code>(array[Layer DiffIDs])</code>: Sort in dependency order, that is, from the bottom layer (Layer) to the top layer (Layer).</li></ul><h5 id="history-array" tabindex="-1"><a class="header-anchor" href="#history-array"><span>history <code>array</code></span></a></h5><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;history&quot;: [{
			&quot;created&quot;: &quot;2017-11-03T22:39:17.173629428Z&quot;,
			&quot;created_by&quot;: &quot;/bin/sh -c #(nop) ADD file:264af0c48e23e8b8fc57c2c70c7b5b08be20601d75f5efca07c5ace8748bcbcd in / &quot;
		},
		{
			&quot;created&quot;: &quot;2017-11-03T22:39:17.345892474Z&quot;,
			&quot;created_by&quot;: &quot;/bin/sh -c #(nop)  CMD [\&quot;sh\&quot;]&quot;,
			&quot;empty_layer&quot;: true
		}
	]
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>history</code> is an object array that describes the history of each layer of the image. The array is sorted according to dependency, that is, from the bottom layer to the top layer. Each object in the array has the following fields:</p><ul><li>created: This field describes the date and time when the layer was created, which must be a string in ISO-8601 format.</li><li>author: This field describes the name and/or email address of the person or entity who created and maintains this layer (Layer).</li><li>created_by: This field describes the instruction called when creating this layer (Layer).</li><li>comment: This field describes the custom comment when creating this layer (Layer).</li><li>empty_layer: This field is used to mark whether the history item causes differences in the file system. If this history item does not correspond to an actual record in <code>rootfs</code>, then this item should be set to <code>true</code>. (Simply, if instructions like ENV, CMD, etc. are executed in the Dockerfile, since these instructions will not cause changes to the file system, <code>empty_layer</code> should be set to <code>true</code>).</li></ul><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>This article primarily begins by outlining the <strong>version history</strong> of Docker image specifications. It then briefly introduces the relationship between the OCI organization and the OCI image specification and the Docker image specification. Next, it demonstrates the <strong>directory structure of Docker images</strong> through a simple yet comprehensive 🌰. Following this example 🌰, the current image specification content is introduced, including the meanings and contents of the <strong>manifest.json</strong> and <strong>Config</strong> files. Since version 1.1 of the image specification, Docker has introduced the concept of <strong>manifest.json</strong>, eliminating the need to concern oneself with the directory structure of images, as all relevant information is now recorded in the manifest.</p><p>By the time you reach this point, the current Docker image specification has been fully covered. Starting from the next article, we will delve into <strong>practical</strong> content. In the upcoming chapters, I will share my experience of <strong>building Docker images from scratch</strong>, further exploring the contents of <code>Filesystem Changeset</code> recorded in each <code>Layer</code> of the image. This will lay the groundwork for the final discussion on how to build images.</p><blockquote><p>Critique: Specifications are often presented in a very formal and verbose manner, yet in reality, Docker&#39;s own image specification is described in a confusing manner, leading to instances of terminology confusion. For example, the <code>Image JSON</code> is referred to as <code>Config</code> within <code>manifest.json</code>; there is also confusion between the image distribution specification and the image specification, with both referring to <code>manifest</code>.</p></blockquote><hr><h2 id="appendix" tabindex="-1"><a class="header-anchor" href="#appendix"><span>Appendix</span></a></h2><h3 id="glossary" tabindex="-1"><a class="header-anchor" href="#glossary"><span>Glossary</span></a></h3><h4 id="layer" tabindex="-1"><a class="header-anchor" href="#layer"><span>Layer</span></a></h4><p>Docker images adopt a layered structure. Each layer is a history of changes to a set of file systems. <code>Layer</code> is not responsible for storing configuration metadata such as environment variables or default parameters, which are properties of the entire image and do not belong to any particular layer.</p><h4 id="image-json" tabindex="-1"><a class="header-anchor" href="#image-json"><span>Image JSON</span></a></h4><p>Each image has an associated JSON structure, referred to as the Image JSON. This structure describes some basic information about the image, such as its creation date, author, the ID of its parent image, and runtime-related configurations (including entry point, default parameters, CPU/memory limits, network configuration, and mounted volume information, etc.). Additionally, this structure records the hash signatures of each layer referenced by the image and provides historical information about these layers.</p><p>According to the specification, this structure is considered immutable because modifying it would require recalculating the <code>ImageID</code>, which in turn means creating a new derived image. The Image JSON of the original image remains unchanged.</p><h4 id="image-filesystem-changeset" tabindex="-1"><a class="header-anchor" href="#image-filesystem-changeset"><span>Image Filesystem Changeset</span></a></h4><p>In a Docker image, each layer stores an archive package, also known as a filesystem changeset, containing files that are added, modified, or deleted relative to the layer below it. By utilizing a layer-based or union filesystem (such as AUFS) or calculating the differences in filesystem snapshots, the <code>filesystem changeset </code> represents a series of image layers as if these changes were applied to the same filesystem.</p><h4 id="layer-diffid" tabindex="-1"><a class="header-anchor" href="#layer-diffid"><span>Layer DiffID</span></a></h4><p>When distributing Docker images, Docker references each layer using the SHA256 digest of its tar archive file. For example, <code>sha256:0271b8eebde3fa9a6126b1f2335e170f902731ab4942f9f1914e77016540c7bb</code> is a valid Layer DiffID.</p><blockquote><p>It&#39;s important to note that packing and unpacking image layers must be done in a reproducible (replayable) manner to prevent changes in the layer IDs. For example, using <code>tar-split</code> to preserve tar headers. Additionally, the Layer DiffID must be calculated from the uncompressed tar version.</p></blockquote><h4 id="layer-chainid" tabindex="-1"><a class="header-anchor" href="#layer-chainid"><span>Layer ChainID</span></a></h4><p>For convenience, sometimes it&#39;s necessary to represent a series of image layers with a single ID. This introduces the concept of the <code>Layer ChainID</code>. For a single-layer image or the bottom-most layer, the <code>Layer ChainID</code> is equivalent to the <code>Layer DiffID</code>. However, for other layers, the <code>Layer ChainID</code> can be calculated using the following formula:</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>ChainID(Layer N) = SHA256hex(ChainID(Layer N-1) + &quot; &quot; + DiffID(Layer N))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This formula calculates the <code>Layer ChainID</code> of Layer N based on the <code>Layer ChainID</code> of the previous layer (Layer N-1) concatenated with the <code>Layer DiffID</code> of Layer N, and then hashed using SHA256.</p><h4 id="imageid" tabindex="-1"><a class="header-anchor" href="#imageid"><span>ImageID</span></a></h4><p>The image ID is calculated using the following formula: <code>ImageID = SHA256hex(Image JSON)</code>. Since the Image JSON references the hash values of every layer in the image, this calculation method makes the image content addressable.</p><blockquote><p>It&#39;s important to note that according to the Docker specification, the Image JSON does not contain any formatting. Therefore, when calculating SHA256hex, it&#39;s crucial to ensure that there is no indentation or formatting present in the JSON structure.</p></blockquote><h4 id="tag" tabindex="-1"><a class="header-anchor" href="#tag"><span>Tag</span></a></h4><p>A <code>Tag</code> can be used to map a descriptive name provided by the user to any single <code>ImageID</code>. The <code>Tag</code> can only consist of characters from the following character set: <code>[a-zA-Z0-9_.-]</code>. Additionally, the first character cannot be <code>.</code> or <code>-</code>, and the length of the <code>Tag</code> cannot exceed <strong>128</strong> characters.</p><h4 id="repository" tabindex="-1"><a class="header-anchor" href="#repository"><span>Repository</span></a></h4><p>The <code>Repository</code> refers to the part of the image name before the <code>:</code>. For example, if an image is named <code>my-app:3.1.4</code>, then <code>my-app</code> is referred to as the <code>Repository</code>. The <code>Repository</code> consists of a name separated by <code>/</code>, which can optionally begin with a DNS hostname prefix (must adhere to standard DNS rules but cannot contain <code>_</code> characters). Additionally, if the <code>Repository</code> includes a hostname, a port number can be added after it (e.g., <code>:8080</code>). Lastly, the <code>Repository</code> cannot begin or end with <code>/</code>.</p><h3 id="image-manifest-version-2" tabindex="-1"><a class="header-anchor" href="#image-manifest-version-2"><span>Image Manifest Version 2</span></a></h3><p>Unlike the <code>Manifest.json</code> in the image specification, the <code>Image Manifest Version 2</code> is primarily used in the <code>Docker Registry API V2</code>, which includes operations such as <code>docker pull</code> and <code>docker push</code>.</p><p>Currently, there are two versions of <code>Image Manifest Version 2</code>:</p><ul><li><a href="https://docs.docker.com/registry/spec/manifest-v2-1/" target="_blank" rel="noopener noreferrer">Image Manifest V 2, Schema 1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://docs.docker.com/registry/spec/manifest-v2-2/" target="_blank" rel="noopener noreferrer">Image Manifest V 2, Schema 2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>This protocol addresses issues related to what images the registry can provide, the format of the images, compatible operating systems, and where the layers of the image should be obtained from by introducing additional media types and the manifest structure of the registry.</p><blockquote><p>Simply, it is a protocol for describing the distribution of image files. OCI has also proposed a specification for this purpose, see also <a href="https://github.com/opencontainers/distribution-spec" target="_blank" rel="noopener noreferrer">OCI Distribution Specification<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></blockquote></div></article><section class="post-meta main-div"><div class="post-date"><span>Writing Date：</span> <span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-01-31T00:00:00.000Z"></span></div><!--v-if--><div class="post-links"><a href="/en/posts/2021/03/31/how-to-run-container-oci-%E8%BF%90%E8%A1%8C%E6%97%B6%E8%A7%84%E8%8C%83.html"><span>：</span><span>How To Run Container:OCI Runtime Specification</span></a></div></section><div id="comment" class="giscus-wrapper input-top blog-post-comments" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></div></main><aside class="blog-aside"><div class="vp-blogger-info main-div" vocab="https://schema.org/" typeof="Person"><div class="vp-blogger" style="cursor:pointer;" aria-label="Personal Intro" data-balloon-pos="down" role="link"><div class="vp-blogger-header"><img class="vp-blogger-avatar round" src="/img/avatar.png" property="image" alt="Blogger Avatar" loading="lazy"></div><div class="vp-blogger-name" property="name">shabbywu</div><div class="vp-blogger-description">Fullstack programer</div><meta property="url" content="/en/resume/"></div><div class="vp-blog-counts"><a class="route-link vp-blog-count" href="/en/article/"><div class="count">7</div><div>Articles</div></a><a class="route-link vp-blog-count" href="/en/category/"><div class="count">1</div><div>Category</div></a><a class="route-link vp-blog-count" href="/en/tag/"><div class="count">5</div><div>Tag</div></a><a class="route-link vp-blog-count" href="/en/timeline/"><div class="count">6</div><div>Timeline</div></a></div><div class="vp-social-medias"><a class="vp-social-media" href="mailto:shabbywu@qq.com" rel="noopener noreferrer" target="_blank" aria-label="Email" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon email-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#1384FF"/><path fill="#fff" d="M270.077 286.233H751.99c32.933 0 59.86 24.855 60.274 55.51l-301.023 157L210.217 341.88c.207-30.723 26.927-55.717 59.86-55.717zm-59.929 115.714-.276 277.756c0 30.931 27.134 56.2 60.205 56.2H751.99c33.14 0 60.274-25.269 60.274-56.2V401.81L518.283 551.492a15.88 15.88 0 0 1-14.43 0L210.148 401.947z"/></svg></a><a class="vp-social-media" href="https://github.com/shabbywu" rel="noopener noreferrer" target="_blank" aria-label="GitHub" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#171515"/><path fill="#fff" d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z"/></svg></a><a class="vp-social-media" href="/feed.json" rel="noopener noreferrer" target="_blank" aria-label="Rss" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon rss-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#FD9B00"/><path fill="#fff" d="M687.981 740.39c0-225.92-183.617-409.777-409.21-409.777v-97.205c279.353 0 506.617 227.506 506.617 506.98H687.98zm-74.841 0h-97.538c0-63.567-24.688-123.245-69.43-167.993-44.762-44.856-104.24-69.556-167.54-69.556v-97.176c184.44 0 334.508 150.046 334.508 334.725zM346.038 605.166c37.35 0 67.514 30.357 67.514 67.39 0 37.146-30.163 67.177-67.514 67.177-37.219 0-67.458-30.03-67.458-67.176 0-37.034 30.24-67.391 67.458-67.391z"/></svg></a></div></div><section class="main-div sticky"><div class="toc-place-holder"><aside id="toc"><!----><div class="toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#preface">Preface</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#docker-image-specification">Docker Image Specification</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#specification-history">Specification History</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#a-🌰-basic-structure-of-docker-images">A 🌰: Basic Structure of Docker Images</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#conclusion">Conclusion</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#appendix">Appendix</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#glossary">Glossary</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#image-manifest-version-2">Image Manifest Version 2</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><div class="toc-comment"><a href="#comment"><span class="font-icon icon comment" style=""></span> </a></div><!--]--></aside></div></section></aside></div><!--]--></div><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer"><a href="http://beian.miit.gov.cn" target="_blank">粤ICP备2021176883号</a></div><div class="vp-copyright"><a href="https://github.com/shabbywu/" target="_blank">shabbywu</a> © 2019-2024</div></footer></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-iv9USOQR.js" defer></script>
  </body>
</html>
