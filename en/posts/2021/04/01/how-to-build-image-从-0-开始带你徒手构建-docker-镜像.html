<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.26" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="zh-cn" href="https://blog.shabbywu.cn/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html"><meta property="og:url" content="https://blog.shabbywu.cn/en/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html"><meta property="og:site_name" content="Personal technical article sharing"><meta property="og:title" content="How To Build Images: Guide you to build Docker image manually from scratch"><meta property="og:description" content="Preface We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is a..."><meta property="og:type" content="article"><meta property="og:image" content="https://blog.shabbywu.cn/img/Docker1.11架构图.png"><meta property="og:locale" content="en-US"><meta property="og:locale:alternate" content="zh-CN"><meta property="og:updated_time" content="2024-03-09T16:14:15.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="How To Build Images: Guide you to build Docker image manually from scratch"><meta property="article:author" content="shabbywu"><meta property="article:tag" content="docker"><meta property="article:tag" content="build"><meta property="article:published_time" content="2021-04-01T00:00:00.000Z"><meta property="article:modified_time" content="2024-03-09T16:14:15.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"How To Build Images: Guide you to build Docker image manually from scratch","image":["https://blog.shabbywu.cn/img/Docker1.11架构图.png","https://blog.shabbywu.cn/img/容器与虚拟机架构对比.png"],"datePublished":"2021-04-01T00:00:00.000Z","dateModified":"2024-03-09T16:14:15.000Z","author":[{"@type":"Person","name":"shabbywu","url":"https://github.com/shabbywu"}]}</script><link rel="alternate" type="application/atom+xml" href="https://blog.shabbywu.cn/en/atom.xml" title="Personal technical article sharing Atom Feed"><link rel="alternate" type="application/json" href="https://blog.shabbywu.cn/en/feed.json" title="Personal technical article sharing JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://blog.shabbywu.cn/en/rss.xml" title="Personal technical article sharing RSS Feed"><link rel="icon" href="/img/avatar.png"><title>How To Build Images: Guide you to build Docker image manually from scratch | Personal technical article sharing</title><meta name="description" content="Preface We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is a...">
    <link rel="preload" href="/assets/app-XpSQsho0.css" as="style"><link rel="stylesheet" href="/assets/app-XpSQsho0.css">
    <link rel="modulepreload" href="/assets/app-iv9USOQR.js"><link rel="modulepreload" href="/assets/how-to-build-image-从-0-开始带你徒手构建-docker-镜像.html-B-9SDbqD.js"><link rel="modulepreload" href="/assets/容器与虚拟机架构对比-Bdzl9MMW.js">
    <link rel="prefetch" href="/assets/index.html-Dw2tmnsH.js" as="script"><link rel="prefetch" href="/assets/index.html-BvujOger.js" as="script"><link rel="prefetch" href="/assets/index.html-CHIm7Skv.js" as="script"><link rel="prefetch" href="/assets/git-merge-method.html-Btz9b4PY.js" as="script"><link rel="prefetch" href="/assets/git-merge-conflicts.html-BrvyetYl.js" as="script"><link rel="prefetch" href="/assets/记一次时区异常问题排查思路和过程.html-DjKs_-jI.js" as="script"><link rel="prefetch" href="/assets/oauth-client-server-side-apps.html-BRCF90Y4.js" as="script"><link rel="prefetch" href="/assets/oauth-client-client-side-apps.html-C4Piky4R.js" as="script"><link rel="prefetch" href="/assets/how-to-build-images-docker-镜像规范.html-DEm1k-_t.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-oci-运行时规范.html-DCqyGvM6.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-从-0-开始带你徒手构建-docker-镜像.html-CjdsXfqT.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-浅谈从镜像创建容器的实现细节.html-BmKHEKnT.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-手把手教你如何推镜像至-docker-registry.html-ycRgd3B9.js" as="script"><link rel="prefetch" href="/assets/wasm-or-container.html-BC2RJBme.js" as="script"><link rel="prefetch" href="/assets/c-tmp-exercise.html-DCEAeMe_.js" as="script"><link rel="prefetch" href="/assets/golang-容易被-k8s-误导的-json-inline.html-DVDmi_BF.js" as="script"><link rel="prefetch" href="/assets/python异步初探-协程的定义.html-7BiD-MCz.js" as="script"><link rel="prefetch" href="/assets/python-auto-doc-for-drf.html-D5_bR_8e.js" as="script"><link rel="prefetch" href="/assets/pydantic-with-drf-yasg.html-Dc_lAfD6.js" as="script"><link rel="prefetch" href="/assets/python异步进阶-探讨协程实现异步的细节.html-P56mA8qN.js" as="script"><link rel="prefetch" href="/assets/fastapi与依赖注入模式.html-Cb2VureC.js" as="script"><link rel="prefetch" href="/assets/bkpaas-refactor-experience.html-b8CxnvHV.js" as="script"><link rel="prefetch" href="/assets/记一次-nginx-ingress-长连接异常断开问题复盘过程.html-D-qKJTH6.js" as="script"><link rel="prefetch" href="/assets/let-s-encrypt-实现全自动免费-https-证书托管-自动签发、续期.html-BWkZbh-B.js" as="script"><link rel="prefetch" href="/assets/index.html-fUCq_CaK.js" as="script"><link rel="prefetch" href="/assets/how-to-build-images-docker-镜像规范.html-D6Vm85Yg.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-oci-运行时规范.html-DKuf6p1f.js" as="script"><link rel="prefetch" href="/assets/how-to-run-container-浅谈从镜像创建容器的实现细节.html-BNKwUaGz.js" as="script"><link rel="prefetch" href="/assets/how-to-build-image-手把手教你如何推镜像至-docker-registry.html-DCt48dCV.js" as="script"><link rel="prefetch" href="/assets/wasm-or-container.html-BcZtMjqw.js" as="script"><link rel="prefetch" href="/assets/404.html-B7mvWyc2.js" as="script"><link rel="prefetch" href="/assets/index.html-DDFO4wUt.js" as="script"><link rel="prefetch" href="/assets/index.html-DNbbggur.js" as="script"><link rel="prefetch" href="/assets/index.html-B0AKgYAp.js" as="script"><link rel="prefetch" href="/assets/index.html-B02RA5O6.js" as="script"><link rel="prefetch" href="/assets/index.html-030TOHWE.js" as="script"><link rel="prefetch" href="/assets/index.html-DyX1vlvx.js" as="script"><link rel="prefetch" href="/assets/index.html-DaQpX6xW.js" as="script"><link rel="prefetch" href="/assets/index.html-CF-2cgkS.js" as="script"><link rel="prefetch" href="/assets/index.html-bZ1iRUM0.js" as="script"><link rel="prefetch" href="/assets/index.html-DzoYoIX0.js" as="script"><link rel="prefetch" href="/assets/index.html-CTDnYwJI.js" as="script"><link rel="prefetch" href="/assets/index.html-CMN1p8gg.js" as="script"><link rel="prefetch" href="/assets/index.html-SuIVStis.js" as="script"><link rel="prefetch" href="/assets/index.html-BL0JCv_d.js" as="script"><link rel="prefetch" href="/assets/index.html-cCGulRAM.js" as="script"><link rel="prefetch" href="/assets/index.html-ve4cmh0I.js" as="script"><link rel="prefetch" href="/assets/index.html-DCY7JPtF.js" as="script"><link rel="prefetch" href="/assets/index.html-BYSJr56O.js" as="script"><link rel="prefetch" href="/assets/index.html-C2dvDLv9.js" as="script"><link rel="prefetch" href="/assets/index.html-DP0kKMRd.js" as="script"><link rel="prefetch" href="/assets/index.html-CP5XIUgE.js" as="script"><link rel="prefetch" href="/assets/index.html-CF-f9AGX.js" as="script"><link rel="prefetch" href="/assets/index.html-DrrqMUt5.js" as="script"><link rel="prefetch" href="/assets/index.html-u4_s61TQ.js" as="script"><link rel="prefetch" href="/assets/index.html-C-o2beRV.js" as="script"><link rel="prefetch" href="/assets/index.html-Dv6k--_O.js" as="script"><link rel="prefetch" href="/assets/index.html-b3CgNTW2.js" as="script"><link rel="prefetch" href="/assets/index.html-CGfYwuXf.js" as="script"><link rel="prefetch" href="/assets/index.html-DHcHmIAn.js" as="script"><link rel="prefetch" href="/assets/index.html-CKoyYuQW.js" as="script"><link rel="prefetch" href="/assets/index.html-C2RMEevR.js" as="script"><link rel="prefetch" href="/assets/index.html-D358tJEd.js" as="script"><link rel="prefetch" href="/assets/index.html-DXfWGbA2.js" as="script"><link rel="prefetch" href="/assets/index.html-CgDOFA_z.js" as="script"><link rel="prefetch" href="/assets/index.html-CI6A7feQ.js" as="script"><link rel="prefetch" href="/assets/index.html-dx836Acv.js" as="script"><link rel="prefetch" href="/assets/index.html-D5_jDjWH.js" as="script"><link rel="prefetch" href="/assets/index.html-Cn2GgVHf.js" as="script"><link rel="prefetch" href="/assets/index.html-XCfIz_vS.js" as="script"><link rel="prefetch" href="/assets/index.html-DF0S3nZ1.js" as="script"><link rel="prefetch" href="/assets/index.html-CW0P11HW.js" as="script"><link rel="prefetch" href="/assets/index.html-BzrF1WSv.js" as="script"><link rel="prefetch" href="/assets/index.html-FsWAkJsu.js" as="script"><link rel="prefetch" href="/assets/index.html-DEtvcX3V.js" as="script"><link rel="prefetch" href="/assets/index.html-BkCvLD_W.js" as="script"><link rel="prefetch" href="/assets/index.html-DhlA2JRc.js" as="script"><link rel="prefetch" href="/assets/giscus-7BMGhbDA.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="header" class="vp-header" style="background-image:url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNDAiIGhlaWdodD0iMjQwIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJyZ2IoMTI0LDc2LDEzMSkiPjwvcmVjdD48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMCwtMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMCwtMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMCwyMTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMCwyMTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTI0MDAwMDAwMDAwMDAwMDEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwLC0zMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMjQwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAsMjEwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjA3MjAwMDAwMDAwMDAwMDAxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MCwtMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDcyMDAwMDAwMDAwMDAwMDEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYwLDIxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAwLC0zMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMTUzMzMzMzMzMzMzMzMzNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAwLDIxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQwLC0zMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQwLDIxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgwLC0zMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgwLDIxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQwLDEwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAzNzMzMzMzMzMzMzMzMzMzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MCwxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMDY2NjY2NjY2NjY2NjY2NyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODAsMTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDcyMDAwMDAwMDAwMDAwMDEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyMCwxMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMzI2NjY2NjY2NjY2NjY2NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwLDEwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAzNzMzMzMzMzMzMzMzMzMzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDAsMTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjMjIyIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTMyNjY2NjY2NjY2NjY2NjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMCw1MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xMzI2NjY2NjY2NjY2NjY2NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjIwLDUwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iIzIyMiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjA4MDY2NjY2NjY2NjY2NjY2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMCw1MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNDYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYwLDUwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDAsNTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDg5MzMzMzMzMzMzMzMzMzMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0MCw1MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgwLDUwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAzNzMzMzMzMzMzMzMzMzMzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDkwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAzNzMzMzMzMzMzMzMzMzMzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNDAsOTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTA2NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQwLDkwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iIzIyMiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjA5OCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODAsOTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDM3MzMzMzMzMzMzMzMzMzMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyMCw5MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwLDkwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iIzIyMiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjE1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDAsOTApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMCwxMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMCwxMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjMjIyIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDI4NjY2NjY2NjY2NjY2NjY3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMCwxMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTI0MDAwMDAwMDAwMDAwMDEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYwLDEzMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4xNDEzMzMzMzMzMzMzMzMzNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAwLDEzMCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wOTgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0MCwxMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjMjIyIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MCwxMzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjMjIyIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMTMyNjY2NjY2NjY2NjY2NjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsMTcwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iIzIyMiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjEzMjY2NjY2NjY2NjY2NjY1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNDAsMTcwKSI+PHJlY3QgeD0iMjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2MCI+PC9yZWN0PjxyZWN0IHg9IjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iMjAiPjwvcmVjdD48L2c+PGcgZmlsbD0iI2RkZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iMC4wMiIgZmlsbC1vcGFjaXR5PSIwLjAzNzMzMzMzMzMzMzMzMzMzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MCwxNzApIj48cmVjdCB4PSIyMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYwIj48L3JlY3Q+PHJlY3QgeD0iMCIgeT0iMjAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCI+PC9yZWN0PjwvZz48ZyBmaWxsPSIjZGRkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjAyIiBmaWxsLW9wYWNpdHk9IjAuMDU0NjY2NjY2NjY2NjY2NjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgwLDE3MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIwLDE3MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiMyMjIiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNjMzMzMzMzMzMzMzMzMzNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwLDE3MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjxnIGZpbGw9IiNkZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDIiIGZpbGwtb3BhY2l0eT0iMC4wNzIwMDAwMDAwMDAwMDAwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAwLDE3MCkiPjxyZWN0IHg9IjIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjAiPjwvcmVjdD48cmVjdCB4PSIwIiB5PSIyMCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+PC9nPjwvc3ZnPg==&quot;);"><div class="vp-navbar-container"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/en/"><img class="vp-nav-logo" src="/img/avatar.png" alt><!----><span class="vp-site-name hide-in-pad">Personal technical article sharing</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/" aria-label="Home"><span class="font-icon icon home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/article/" aria-label="Articles"><span class="font-icon icon book" style=""></span>Articles<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/en/resume/" aria-label="About Me"><span class="font-icon icon circle-question" style=""></span>About Me<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="dropdown-item"><a class="route-link nav-link active" href="/en/posts/2021/04/01/how-to-build-image-%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%B8%A6%E4%BD%A0%E5%BE%92%E6%89%8B%E6%9E%84%E5%BB%BA-docker-%E9%95%9C%E5%83%8F.html" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/shabbywu/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></div><div class="banner"><h1 class="text">How To Build Images: Guide you to build Docker image manually from scratch</h1></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><div><!--[--><div class="blog-page"><main id="main-content" class="blog-main"><div class="blog-post custom"><section class="post-meta main-div"><div class="post-date"><span>Writing Date：</span> <span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-04-01T00:00:00.000Z"></span></div><div class="post-links"><a href="/en/posts/2021/03/31/how-to-run-container-oci-%E8%BF%90%E8%A1%8C%E6%97%B6%E8%A7%84%E8%8C%83.html" class=""><span>：</span><span>How To Run Container:OCI Runtime Specification</span></a></div><div class="post-links"><a href="/en/posts/2021/08/12/how-to-run-container-%E6%B5%85%E8%B0%88%E4%BB%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html" class=""><span>：</span><span>How To Run Container - Discussion on the implementation details of creating a container from an image</span></a></div></section><article class="blog-post-content main-div"><div class="vp-page-title"><h1><!---->How To Build Images: Guide you to build Docker image manually from scratch</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/shabbywu" target="_blank" rel="noopener noreferrer">shabbywu</a></span><span property="author" content="shabbywu"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-04-01T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 10 min</span><meta property="timeRequired" content="PT10M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category0 clickable" role="navigation">Container Technology</span><!--]--><meta property="articleSection" content="Container Technology"></span><!----></div><hr></div><div class="theme-hope-content" id="markdown-content"><h2 id="preface" tabindex="-1"><a class="header-anchor" href="#preface"><span>Preface</span></a></h2><p>We are now in the era of containerization, where hardly anyone in development, testing, or operations would be unfamiliar with or unable to use Docker. Using Docker is also straightforward; most of the time, launching a container simply involves executing <code>docker run {your-image-name}</code>, and building an image is as simple as executing <code>docker build dockerfile .</code>.<br> Perhaps it&#39;s precisely because Docker encapsulates implementation details so thoroughly that I recently realized that we may have only learned <strong>how to use Docker CLI</strong>, rather than understanding how Docker actually operates.<br> In the <strong>『How To Build Images』</strong> series, I will discuss the implementation details related to <code>Docker build dockerfile .</code>. This article is the second installment of this series and will demonstrate the knowledge required to build Docker images from scratch.</p><blockquote><p>Note: This article assumes that readers know how to use Docker, including but not limited to knowing how to execute <code>docker run</code> and <code>docker build</code> and writing a Dockerfile. Additionally, readers should be familiar with the <a class="route-link" href="/en/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html">Docker Image Specification</a>.</p></blockquote><h2 id="exploring-the-depths-how-containers-actually-run" tabindex="-1"><a class="header-anchor" href="#exploring-the-depths-how-containers-actually-run"><span>Exploring the Depths - How Containers Actually Run</span></a></h2><h3 id="overview-of-docker-architecture" tabindex="-1"><a class="header-anchor" href="#overview-of-docker-architecture"><span>Overview of Docker Architecture</span></a></h3><p>Before delving into building images, it&#39;s essential to understand how Docker transforms images into containers. Starting from Docker 1.11, the architecture of Docker evolved into the following model: <img src="/img/Docker1.11架构图.png" alt="Docker 1.11 Architecture" loading="lazy"></p><p>As shown in the diagram, Docker splits the runtime into two modules, namely <strong>containerd</strong> and <strong>runc</strong>. Both of these are products of container technology standardization. <strong>Containerd</strong> is responsible for higher-level functionalities such as image management and networking infrastructure, while <strong>runc</strong> focuses on lower-level functionalities like container management and containerization technology.</p><p>When we execute <code>docker run</code> command, it goes through the following steps: <em>Docker CLI</em> communicates with <em>Docker Engine</em>, which then parses the request and forwards it to <em>containerd</em>. Finally, <em>containerd</em>, with the help of <em>containerd-shim</em> as a converter, invokes <em>runc</em> to create and run the container.</p><p>In that case, can we directly call <code>runc</code> to create containers without docker? The answer is yes. We only need to organize the container as a Filesystem Bundle according to the <strong>OCI Runtime Specification</strong>, and then we can use <code>runc</code> to start the container.</p><blockquote><p>Note 1: For Linux systems, Docker installation usually includes runc. If runc is not installed on the local machine, precompiled <a href="https://github.com/opencontainers/runc/releases" target="_blank" rel="noopener noreferrer">runc binary files<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> can be downloaded directly from GitHub. Note 2: For readers interested in further understanding the <strong>OCI Runtime Specification</strong>, you can read another series of articles by the author titled <a class="route-link" href="/en/posts/2021/03/31/how-to-run-container-oci-%E8%BF%90%E8%A1%8C%E6%97%B6%E8%A7%84%E8%8C%83.html">『How To Run Container: OCI Runtime Specification』</a>.</p></blockquote><h3 id="runc-how-to-run-container-from-image" tabindex="-1"><a class="header-anchor" href="#runc-how-to-run-container-from-image"><span>runc - How to run container from image</span></a></h3><p>According to the <strong>OCI Runtime Specification</strong>, a basic container should have the following directory structure:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.
├── config.json
└── $root.path
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Typically, <code>$root.path</code> is named to <strong>rootfs</strong>.</p></blockquote><p>First, let&#39;s create an empty directory to organize the container filesystem bundle.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>➜ cd /some-path
## Create filesystem bundle directory
➜ mkdir mycontainer &amp;&amp; cd mycontainer

## Create rootfs directory
➜ mkdir rootfs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The next step is to generate the <code>config.json</code> file. Since the OCI Runtime Specification is quite complex, manually configuring <code>config.json</code> can be time-consuming. However, fortunately, <code>runc</code> has reserved special commands to facilitate the generation of basic specification templates.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## Generate basic template
➜ runc spec
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Although we haven&#39;t put anything into the container&#39;s root filesystem yet, let&#39;s try to see if the container can run. Who knows, maybe it will work?</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>➜ runc run mycontainer
## ERRO[0000] container_linux.go:349: starting container process caused &quot;exec: \&quot;sh\&quot;: executable file not found in $PATH&quot;
## container_linux.go:349: starting container process caused &quot;exec: \&quot;sh\&quot;: executable file not found in $PATH&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As expected, an error occurred... After all, our container doesn&#39;t have anything in it, so how could it run?<br> Now we&#39;ve reached the final but also the most crucial step, which is <strong>creating the content of the container&#39;s root filesystem</strong>. But we have no idea what should be in the container in the first place... What should we do? Let&#39;s export a container from Docker and take a look at what it should look like!</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## Export the busybox container
➜ docker export $(docker create --name busybox busybox) | tar -C rootfs -xvf - &amp;&amp; docker stop busybox &amp;&amp; docker rm busybox

## Confirm the content of rootfs
➜ ls rootfs
bin  dev  etc  home  proc  root  sys  tmp  usr  var

## Start the container
➜ runc run mycontainer

## Execute ls, hostname, and whoami inside the container
➜ ls
bin   dev   etc   home  proc  root  sys   tmp   usr   var

➜ hostname
runc

➜ whoami
root
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here we have successfully started the container using runc. Let&#39;s summarize:<br> Running a container directly is quite simple. You just need to:</p><ol><li>Organize the container as a Filesystem Bundle.</li><li>Write the correct configuration in <code>config.json</code>.</li><li>Populate the <code>$root.path</code> with appropriate and available files.</li><li>Execute <code>runc run $containerid</code> to start the container.</li></ol><h2 id="learning-by-doing-building-runnable-container-bundles" tabindex="-1"><a class="header-anchor" href="#learning-by-doing-building-runnable-container-bundles"><span>Learning by Doing - Building Runnable Container Bundles</span></a></h2><p>In the previous section, we utilized Docker to export the root filesystem of a runnable container. But what if we want to create a simple runnable container without relying on external tools? The answer is yes, but before that, let&#39;s review some knowledge about containers.</p><h3 id="differences-between-containers-and-virtual-machines" tabindex="-1"><a class="header-anchor" href="#differences-between-containers-and-virtual-machines"><span>Differences Between Containers and Virtual Machines</span></a></h3><p>A virtual machine (VM) runs a guest operating system (Guest OS) on top of a host operating system (Host OS) and can access the underlying hardware, such as Linux or Windows. On the other hand, a container is a lightweight application code package that includes dependencies, such as specific versions of programming language runtimes and libraries required to run software services. Similar to virtual machines, containers provide users with isolated environments to run applications, but they have fundamental differences:</p><ul><li>Containers virtualize at the operating system level, while virtual machines virtualize at the hardware level.</li><li>Containers share the operating system kernel with the host operating system (Host OS), whereas virtual machines use the operating system kernel provided by the guest operating system (Guest OS). <img src="/img/容器与虚拟机架构对比.png" alt="Comparison of Container and Virtual Machine Architectures" loading="lazy"></li></ul><p>The advantages brought by the differences between container and virtual machine architectures have probably been discussed extensively. Here, I won&#39;t dwell on that. Instead, let&#39;s focus on the <strong>startup</strong> process.</p><h3 id="startup-process-of-virtual-machines" tabindex="-1"><a class="header-anchor" href="#startup-process-of-virtual-machines"><span>Startup Process of Virtual Machines</span></a></h3><p>Since virtual machines virtualize at the hardware level, the startup process of a virtual machine is essentially the same as the boot process of a computer. The complete boot process of a computer consists of at least 4 stages:</p><div class="language-plantuml line-numbers-mode" data-ext="plantuml" data-title="plantuml"><pre class="language-plantuml"><code><img src="https://www.plantuml.com/plantuml/svg/FK-rTKD14ColYdbAp5I0EJ6p2zXtk8BR8xDLkrW_MXmwgurA-nWDLHrmJ5He1DADFxdzl0PA5g8RUObgTclSM28kPPG-cYsu46duKvlRMzWxmSNruolKhEdTK-tEBrPBCTYyltZPwislTq8650skuuoEXlnhSMjBjCC5zdNk1poxuQc8jhLYCx71qH8zqrBZURFyUw-sxBqcgzcnDJXFQSYQvYwhEhFHp89D0G00
"></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="startup-process-of-containers" tabindex="-1"><a class="header-anchor" href="#startup-process-of-containers"><span>Startup Process of Containers</span></a></h3><p>As containers share the operating system kernel with the host, the startup process of a container involves only 2 stages:</p><div class="language-plantuml line-numbers-mode" data-ext="plantuml" data-title="plantuml"><pre class="language-plantuml"><code><img src="https://www.plantuml.com/plantuml/svg/7Owr5SGm38PxJw7kU8HZBey6q7D80TdFLd8yUwZzyLjvGITbaIkV4LjqM01geOhaVKlGXc2qO6nOjPwGa67O6XOa3XtS-hA5hngEHp1Rm9dR2ERq2U5Qib0HmfuhSeQBa4MrYRu23n-wsSs6cY8A0rXRcvF6RjrteNPD_TKgvA0bQm00
"></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The biggest difference between the startup processes of virtual machines and containers is that, before starting the user-specified applications, virtual machines need to execute the <code>computer boot</code> process, while containers, after <code>initializing the runtime environment</code>, immediately start the user-specified applications. This results in the <strong>pid 1</strong> process seen in the container being the <strong>user-specified application</strong>.<br> On the other hand, because container startup does not involve the stages of <code>loading and initializing the kernel</code> and <code>starting the init process</code>, container images do not need to include components such as the operating system kernel and init process.<br> In summary, creating a simple runnable container only requires preparing the user-specified application and its dependencies, without any additional components.</p><h3 id="a-very-simple-executable-program" tabindex="-1"><a class="header-anchor" href="#a-very-simple-executable-program"><span>A Very Simple Executable Program</span></a></h3><p>In this section, our main task is to create a simple executable program. What kind of executable program is the simplest? As the saying goes, &quot;All Dharmas Return to the Origin&quot;, the simplest program must be written in assembly language. Here is a piece of assembly code written using nasm:</p><div class="language-nasm line-numbers-mode" data-ext="nasm" data-title="nasm"><pre class="language-nasm"><code>section .data
     msg:     db   &quot;Hello runc!&quot;, 13, 10; 10 is the ASCII code for \n (LF), and 13 is the ASCII code for \r (CR)
     msglen:  equ  $ - msg;

section .text
     global _start 

_start:
     mov eax, 4        ; 4 corresponds to sys_write system call
     mov ebx, 1        ; sys_write system call first parameter: file descriptor, 1 for standard output
     mov ecx, msg      ; sys_write system call second parameter: offset address of the string to be output
     mov edx, msglen   ; sys_write system call third parameter: string length
     int 80h           ; 80h interrupt, triggers a system call

     mov eax, 1   ; 1 corresponds to exit system call
     mov ebx, 0   ; exit system call parameter: return code
     int 80h      ; 80h interrupt, triggers a system call
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We won&#39;t delve into the components of the nasm assembly language here. For now, all we need to do is compile and link it to generate an executable program.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## We are still in the `mycontainer` directory. Let&#39;s output the above code to a file named hello.nasm
## Compile hello.nasm using nasm, making sure to set the output format to ELF64 (x86-64) (Linux, most Unix variants)
➜ nasm hello.nasm -f elf64 -o hello.o

## Link the object file to create an executable program
➜ ld hello.o -o hello

## Test the execution
➜ ./hello
Hello runc!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With the above steps, we now have a standalone executable file that can be run on the x86-64 architecture Linux platform. Now, let&#39;s try executing it inside a container.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## First, clear the rootfs directory
➜ rm -r -f rootfs &amp;&amp; mkdir rootfs

## Copy the hello file to the rootfs directory
➜ cp hello rootfs/

## Ensure that the rootfs directory contains only the hello file
➜ ls -la rootfs
total 12
drwxr-xr-x 2 root root 4096 Apr  8 20:40 .
drwxr-xr-x 3 root root 4096 Apr  8 20:40 ..
-rwxr-xr-x 1 root root 1040 Apr  8 20:40 hello

## Start the container!
➜ runc run mycontainer
ERRO[0000] container_linux.go:367: starting container process caused: exec: &quot;sh&quot;: executable file not found in $PATH
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And as expected, an error occurred...<br> According to the error message, the default startup program specified by the runtime configuration template is <code>sh</code>. However, since our container is extremely simple, it doesn&#39;t even have the <code>sh</code> program, hence the error. We just need to modify the <strong>process.args</strong> to <code>/hello</code>.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## Replace &quot;sh&quot; with &quot;/hello&quot;
➜ sed -i &quot;s/\&quot;sh\&quot;/\&quot;\/hello\&quot;/&quot; config.json

## Start the container!
➜ runc run mycontainer
Hello runc!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here we have successfully started our container with content we filled ourselves. Let&#39;s summarize the steps for building a runnable container from scratch:</p><ol><li>Organize the container as a Filesystem Bundle.</li><li>Add the user-specified application and its dependencies to <code>$root.path</code>.</li><li>Ensure that the command specified in <strong>process.args</strong> of <code>config.json</code> is executable within the container.</li><li>Execute <code>runc run $containerid</code>.</li></ol><h2 id="step-ahead-packaging-the-image-archive" tabindex="-1"><a class="header-anchor" href="#step-ahead-packaging-the-image-archive"><span>Step Ahead - Packaging the Image Archive</span></a></h2><p>In the previous section, we mimicked the process and constructed an extremely simple executable container. Now, is there a way to package this container into an image and import it into Docker? The answer is yes, and with the knowledge we currently have, we&#39;re well equipped to meet this requirement. First, let&#39;s review the basic directory structure of a Docker image archive.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.
├── 036a82c6d65f2fa43a13599661490be3fca1c3d6790814668d4e8c0213153b12
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 6ad733544a6317992a6fac4eb19fe1df577d4dec7529efec28a5bd0edad0fd30.json
├── manifest.json
└── repositories

1 directory, 6 files
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Among these, only the elements declared in <code>manifest.json</code> are necessary components of the image archive. Other files are irrelevant. In other words, we only need to focus on <code>layer.tar</code>, <code>config.json</code>, and <code>manifest.json</code>.</p><blockquote><p>Note 1: <code>config.json</code> is also known as Image JSON, commonly named after its own sha256sum in the archive. In the example above, it is <code>6ad733544a6317992a6fac4eb19fe1df577d4dec7529efec28a5bd0edad0fd30.json</code>. Note 2: For a detailed explanation of the components and their meanings in a container image archive, please refer to the previous article in this series, <a class="route-link" href="/en/posts/2021/01/31/how-to-build-images-docker-%E9%95%9C%E5%83%8F%E8%A7%84%E8%8C%83.html">How To Build Images: Docker Image Specification v1.2</a>.</p></blockquote><h3 id="building-layer-tar" tabindex="-1"><a class="header-anchor" href="#building-layer-tar"><span>Building layer.tar</span></a></h3><p>The layer archive records the change history of the image content. In our case, this image consists of only one layer, so we just need to package the <code>hello</code> file into the archive.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## We are currently in the mycontainer directory
## Create the layer archive layer.tar
➜ tar -cf layer.tar -C rootfs hello

## Verify the contents of the archive
➜ tar -tvf layer.tar
-rwxr-xr-x root/root      1040 2021-04-08 20:40 hello

## Calculate the sha256sum of layer.tar for later use
➜ sha256sum layer.tar
45f29debe3c1db5d78d29583a12cb58208ca1942b23e281e9c5894182b5ffb97  layer.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="building-config-json" tabindex="-1"><a class="header-anchor" href="#building-config-json"><span>Building config.json</span></a></h3><p>Image JSON contains basic information related to the image and runtime configurations. This makes building config.json the most complex step. To keep this section concise, the resulting configuration is shown directly below, with key data sources described in comments.</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>{
    &quot;architecture&quot;: &quot;amd64&quot;,
    &quot;config&quot;: {
        &quot;User&quot;: &quot;&quot;,
        &quot;Tty&quot;: false,
        &quot;Env&quot;: [&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;],
        &quot;Cmd&quot;: [&quot;/hello&quot;],
        &quot;Volumes&quot;: null,
        &quot;WorkingDir&quot;: &quot;/&quot;,
        &quot;Entrypoint&quot;: null,
        &quot;Labels&quot;: null
    },
    &quot;created&quot;: &quot;1970-01-01T00:00:00.0Z&quot;,
    &quot;docker_version&quot;: &quot;20.10.5&quot;,
    &quot;history&quot;: [],
    &quot;os&quot;: &quot;linux&quot;,
    &quot;rootfs&quot;: {
        &quot;type&quot;: &quot;layers&quot;,
        &quot;diff_ids&quot;: [&quot;sha256:45f29debe3c1db5d78d29583a12cb58208ca1942b23e281e9c5894182b5ffb97&quot;]
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After compressing the above configuration (removing comments), calculate the sha256sum of the compressed content and name it as ${sha256sum}.json.</p><blockquote><p>The sha256sum corresponding to the above configuration is 112e38209f1b62794b83d25708b5ab354792a8155453d151aac8dadca11e2c48.</p></blockquote><h3 id="building-manifest-json" tabindex="-1"><a class="header-anchor" href="#building-manifest-json"><span>Building manifest.json</span></a></h3><p><code>manifest.json</code> records a list, where each item describes a manifest of the image and its parent image (optional). Since our image doesn&#39;t have a parent image, we only need to record one structure. The specific configuration is as follows:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>[
  {
    &quot;Config&quot;: &quot;112e38209f1b62794b83d25708b5ab354792a8155453d151aac8dadca11e2c48.json&quot;,
    &quot;RepoTags&quot;: [
      &quot;hello-runc:nasm&quot;
    ],
    &quot;Layers&quot;: [
      &quot;layer.tar&quot;
    ]
  }
]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="packaging-archive" tabindex="-1"><a class="header-anchor" href="#packaging-archive"><span>Packaging Archive</span></a></h3><p>Place the above files into the same directory layer, and use tar to package and archive.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## We are currently in the mycontainer directory
## Make sure the above files are all in the mycontainer directory
➜ ls 
112e38209f1b62794b83d25708b5ab354792a8155453d151aac8dadca11e2c48.json  config.json  layer.tar  manifest.json  rootfs

## Packaging archive
➜ tar -cf image.tar 112e38209f1b62794b83d25708b5ab354792a8155453d151aac8dadca11e2c48.json layer.tar manifest.json

## Verify the contents of the archive
➜  tar -tvf image.tar
-rw-r--r-- root/root       417 2021-04-08 22:14 112e38209f1b62794b83d25708b5ab354792a8155453d151aac8dadca11e2c48.json
-rw-r--r-- root/root     10240 2021-04-08 22:14 layer.tar
-rw-r--r-- root/root       188 2021-04-08 22:14 manifest.json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="importing-images" tabindex="-1"><a class="header-anchor" href="#importing-images"><span>Importing Images</span></a></h3><p>Importing images in Docker is straightforward, requiring only the execution of the <code>docker load</code> command. The following demonstrates the process of importing an image.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## We are currently in the mycontainer directory
## Ensure that the hello-runc image does not exist previously
➜ docker images hello-runc
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE

## Execute the command to import the image
➜ docker load -i image.tar
Loaded image: hello-runc:nasm

## Verify that the image now exists
➜ docker images hello-runc
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
hello-runc   nasm      112e38209f1b   51 years ago   1.04kB
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>At this point, we have manually built a Docker image and successfully imported it into the Docker image list. To celebrate this success, we&#39;ll move the verification process to the next section. Let&#39;s summarize briefly. Building a Docker image manually is quite simple, requiring:</p><ol><li>Orchestrating the container into a Filesystem Bundle format.</li><li>Packaging the container Filesystem Bundle into a layer.tar file.</li><li>Writing image configuration information (Image JSON, config.json for the image) according to the container runtime configuration (runc&#39;s config.json).</li><li>Writing a container manifest file (manifest.json).</li><li>Tar packaging and archiving into an image.</li></ol><h2 id="mission-completed-container-runtime-verification-results-and-summary" tabindex="-1"><a class="header-anchor" href="#mission-completed-container-runtime-verification-results-and-summary"><span>Mission Completed - Container Runtime Verification Results and Summary</span></a></h2><p>In the previous section, we manually built a Docker image and successfully imported it into the Docker image list. Now, it&#39;s time to heavily utilize this image to create containers! 😁</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>## We are currently in the mycontainer directory, but it&#39;s not crucial.
## Creating a container with default parameters
➜ docker run --rm hello-runc:nasm
WARNING: IPv4 forwarding is disabled. Networking will not work.
Hello runc!

## Creating a container by specifying a startup command
➜ docker run --rm hello-runc:nasm /hello
WARNING: IPv4 forwarding is disabled. Networking will not work.
Hello runc!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So far, we&#39;ve successfully built a Docker image from scratch, imported it into the Docker image list, and run it smoothly in containers. This confirms the possibility of manually building Docker images.</p><p>In conclusion, building Docker images is quite simple, requiring:</p><ol><li>Familiarity with Docker image specifications.</li><li>Preparation of the container runtime environment, including the application and its dependencies, such as specific versions of programming language runtimes and libraries required for running software services.</li><li>Organizing archives of each layer of the image (layer.tar) and computing the Layer DiffID.</li><li>Writing image configuration information (Image JSON) according to the specifications and computing ImageID.</li><li>Writing a container manifest file (manifest.json).</li><li>Tar packaging and archiving into an image.</li></ol><p>This article is the second installment of the 『How To Build Images』 series, focusing on how runc runs containers. It delves into the various steps and implementation details of building Docker images. So far, we have gained a preliminary understanding of <strong>How To Build Images</strong>. The next article in this series will delve into the interaction process between the Docker Daemon and Docker Registry, dissecting the details hidden behind <code>docker pull</code> and <code>docker push</code>. <sub><s>Just listening to your bragging</s></sub></p><hr><h2 id="appendix" tabindex="-1"><a class="header-anchor" href="#appendix"><span>Appendix</span></a></h2><h3 id="the-smallest-image-none-smaller" tabindex="-1"><a class="header-anchor" href="#the-smallest-image-none-smaller"><span>The Smallest Image - None Smaller</span></a></h3><p>In this article, we built a runnable container with a size of only <strong>1.04kB</strong>. But is it possible to build an even smaller container? The answer is yes, and that&#39;s with the Docker-provided <strong>scratch</strong> image, which contains absolutely nothing, and <strong>cannot be downloaded</strong> through normal means.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>➜ docker pull scratch
Using default tag: latest
Error response from daemon: &#39;scratch&#39; is a reserved name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Although the <strong>scratch</strong> image cannot be pulled through normal means, Docker provides a method to build this image:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>➜ tar cv --files-from /dev/null | docker import - scratch
sha256:12973c2ef51625eb40e47970903b97629f9942ba03a087b73c4f2afc520a3757
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>After executing the above command, you&#39;ll find a zero-byte image in your image list~</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>➜ docker images
REPOSITORY         TAG       IMAGE ID       CREATED         SIZE
scratch            latest    72a1f559e368   2 seconds ago   0B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><section class="post-meta main-div"><div class="post-date"><span>Writing Date：</span> <span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-04-01T00:00:00.000Z"></span></div><div class="post-links"><a href="/en/posts/2021/03/31/how-to-run-container-oci-%E8%BF%90%E8%A1%8C%E6%97%B6%E8%A7%84%E8%8C%83.html"><span>：</span><span>How To Run Container:OCI Runtime Specification</span></a></div><div class="post-links"><a href="/en/posts/2021/08/12/how-to-run-container-%E6%B5%85%E8%B0%88%E4%BB%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html"><span>：</span><span>How To Run Container - Discussion on the implementation details of creating a container from an image</span></a></div></section><div id="comment" class="giscus-wrapper input-top blog-post-comments" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></div></main><aside class="blog-aside"><div class="vp-blogger-info main-div" vocab="https://schema.org/" typeof="Person"><div class="vp-blogger" style="cursor:pointer;" aria-label="Personal Intro" data-balloon-pos="down" role="link"><div class="vp-blogger-header"><img class="vp-blogger-avatar round" src="/img/avatar.png" property="image" alt="Blogger Avatar" loading="lazy"></div><div class="vp-blogger-name" property="name">shabbywu</div><div class="vp-blogger-description">Fullstack programer</div><meta property="url" content="/en/resume/"></div><div class="vp-blog-counts"><a class="route-link vp-blog-count" href="/en/article/"><div class="count">7</div><div>Articles</div></a><a class="route-link vp-blog-count" href="/en/category/"><div class="count">1</div><div>Category</div></a><a class="route-link vp-blog-count" href="/en/tag/"><div class="count">5</div><div>Tag</div></a><a class="route-link vp-blog-count" href="/en/timeline/"><div class="count">6</div><div>Timeline</div></a></div><div class="vp-social-medias"><a class="vp-social-media" href="mailto:shabbywu@qq.com" rel="noopener noreferrer" target="_blank" aria-label="Email" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon email-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#1384FF"/><path fill="#fff" d="M270.077 286.233H751.99c32.933 0 59.86 24.855 60.274 55.51l-301.023 157L210.217 341.88c.207-30.723 26.927-55.717 59.86-55.717zm-59.929 115.714-.276 277.756c0 30.931 27.134 56.2 60.205 56.2H751.99c33.14 0 60.274-25.269 60.274-56.2V401.81L518.283 551.492a15.88 15.88 0 0 1-14.43 0L210.148 401.947z"/></svg></a><a class="vp-social-media" href="https://github.com/shabbywu" rel="noopener noreferrer" target="_blank" aria-label="GitHub" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#171515"/><path fill="#fff" d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z"/></svg></a><a class="vp-social-media" href="/feed.json" rel="noopener noreferrer" target="_blank" aria-label="Rss" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon rss-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#FD9B00"/><path fill="#fff" d="M687.981 740.39c0-225.92-183.617-409.777-409.21-409.777v-97.205c279.353 0 506.617 227.506 506.617 506.98H687.98zm-74.841 0h-97.538c0-63.567-24.688-123.245-69.43-167.993-44.762-44.856-104.24-69.556-167.54-69.556v-97.176c184.44 0 334.508 150.046 334.508 334.725zM346.038 605.166c37.35 0 67.514 30.357 67.514 67.39 0 37.146-30.163 67.177-67.514 67.177-37.219 0-67.458-30.03-67.458-67.176 0-37.034 30.24-67.391 67.458-67.391z"/></svg></a></div></div><section class="main-div sticky"><div class="toc-place-holder"><aside id="toc"><!----><div class="toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#preface">Preface</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#exploring-the-depths-how-containers-actually-run">Exploring the Depths - How Containers Actually Run</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#overview-of-docker-architecture">Overview of Docker Architecture</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#runc-how-to-run-container-from-image">runc - How to run container from image</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#learning-by-doing-building-runnable-container-bundles">Learning by Doing - Building Runnable Container Bundles</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#differences-between-containers-and-virtual-machines">Differences Between Containers and Virtual Machines</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#startup-process-of-virtual-machines">Startup Process of Virtual Machines</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#startup-process-of-containers">Startup Process of Containers</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#a-very-simple-executable-program">A Very Simple Executable Program</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#step-ahead-packaging-the-image-archive">Step Ahead - Packaging the Image Archive</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#building-layer-tar">Building layer.tar</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#building-config-json">Building config.json</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#building-manifest-json">Building manifest.json</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#packaging-archive">Packaging Archive</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#importing-images">Importing Images</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#mission-completed-container-runtime-verification-results-and-summary">Mission Completed - Container Runtime Verification Results and Summary</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#appendix">Appendix</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#the-smallest-image-none-smaller">The Smallest Image - None Smaller</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><div class="toc-comment"><a href="#comment"><span class="font-icon icon comment" style=""></span> </a></div><!--]--></aside></div></section></aside></div><!--]--></div><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer"><a href="http://beian.miit.gov.cn" target="_blank">粤ICP备2021176883号</a></div><div class="vp-copyright"><a href="https://github.com/shabbywu/" target="_blank">shabbywu</a> © 2019-2024</div></footer></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-iv9USOQR.js" defer></script>
  </body>
</html>
